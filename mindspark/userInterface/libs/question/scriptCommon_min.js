function noenter(e){e=e||window.event;var t=e.keyCode||e.charCode;return 13!==t}function checkLoadingComplete(){for(var e=document.images,t=!0,s=0;s<e.length;s++)0==e[s].complete&&(t=!1),"undefined"!=typeof e[s].naturalWidth&&0==e[s].naturalWidth&&(t=!1);if(t){var o=new Date;plstart=null!=plstart?new Date(plstart):o;var n=(o.getTime()-plstart.getTime())/1e3;document.getElementById("pageloadtime")&&$("#pageloadtime").val(n),initializeTimer()}else window.setTimeout("checkLoadingComplete()",500)}function getDAQuestionDirect(e,t){var s=$("#qno").val();if(isLoadedDAQue===!1||e==s)return!1;isLoadedDAQue=!1,$("#daFlagCheck").attr("checked")&&$("#"+s+"box").addClass("daPagingYellow"),$("#"+e+"box").hasClass("daPagingYellow")?($("#daFlagCheck").attr("checked",!0),$("#prevDAQuesFlag").val(1)):$("#daFlagCheck").attr("checked",!1);var o=$(".optionActive").text(),n=($("#qno").val(),$("#qcode").val(),o);""==n&&(n="No Answer");newQues.checkAnswerMCQ(n);prevQno=$("#qno").val();var r=$("#daTestQueCount").val(),i=$("#daPaperCode").val();$("#"+e+"box").hasClass("daPagingnormal")||(setDaColorCode(prevQno,e,"no"),$(".optionX").removeClass("optionActive"),params="qcode="+t+"&mode=firstQuestion&quesCategory=daTest&qno="+e+"&linkedquestion=1&daTestCode="+i+"&paperQueCount="+r,getNextQues(params,"normal"),refreshProgessBar=1,fetchNextQues()),isLoadedDAQue=!0}function refreshScrollBar(){var e=$("#scroll").jScrollPane({showArrows:!0,arrowSize:17,autoReinitialise:!0}).data("jsp");e.reinitialise()}function sample(){$("#prompt").css("height","130%"),$("#prompt").css("display","none")}function openWildcardInstruction(){$.fn.colorbox({href:"#instruction",inline:!0,open:!0,escKey:!0,height:350,width:500})}function clusterStatusPromptfn(){$.fn.colorbox({href:"#clusterStatusPrompts",inline:!0,open:!0,escKey:!0,height:250,width:450})}function openHelp(e,t){var s=window.innerWidth;if(1==e)var o=t+"theme1/index.html";else if(2==e)var o=t+"theme2/index.html";else if(3==e)var o=t+"theme3/index.html";s>1024?($("#iframeHelp").attr("height","440px"),$("#iframeHelp").attr("width","960px"),$("#iframeHelp").attr("src",o),$.fn.colorbox({href:"#openHelp",inline:!0,open:!0,escKey:!0,height:570,width:1024})):($("#iframeHelp").attr("height","390px"),$("#iframeHelp").attr("width","700px"),$("#iframeHelp").attr("src",o),$.fn.colorbox({href:"#openHelp",inline:!0,open:!0,escKey:!0,height:500,width:800}))}function openHelp1(e,t){var s=window.innerWidth,o=t+"interface"+e+"/TPDemoInterface/index.html";s>1024?($("#iframeHelp").attr("height","440px"),$("#iframeHelp").attr("width","960px"),$("#iframeHelp").attr("src",o),$.fn.colorbox({href:"#openHelp",inline:!0,open:!0,escKey:!0,height:570,width:1024})):($("#iframeHelp").attr("height","390px"),$("#iframeHelp").attr("width","700px"),$("#iframeHelp").attr("src",o),$.fn.colorbox({href:"#openHelp",inline:!0,open:!0,escKey:!0,height:500,width:800}))}function getNextQues(e,t){("daTest"==$("#quesCategory").val()||-1==e.search(/nextQuesLoaded=1/))&&(ajaxFailure=!0,responseArray="",$.ajax("controller.php",{type:"post",data:e,success:function(e,s){if(ajaxFailure=!1,0!=s){var o=e;if("DUPLICATE"==trim(o)||"SESSION_EXPIRED"==trim(o))return redirect=0,setTryingToUnload(),void(window.location="error.php");if("DUPLICATE_QUESTION"==trim(o).substring(0,18))return alert("Something went wrong while displaying this question. To continue, please login again and continue your session."),$.ajax({url:"errorLog.php",type:"POST",data:"params= request- "+$("#quesform").find("input").serialize()+" response-"+encodeURIComponent(o)+"&qcode="+$("#qcode").val()+"&typeErrorLog=duplicateQuestion",dataType:"text",async:!1}),redirect=0,setTryingToUnload(),void(window.location="logout.php");if("DUPLICATE_TAB"==trim(o))return alert("It seems mindspark is open in multiple tabs.Please re-login again."),redirect=0,setTryingToUnload(),void(window.location="logout.php");if(o.indexOf("Mindspark | Error Page")>=0)return setTryingToUnload(),window.location.href="error.php",!1;try{responseArray=$.parseJSON(o)}catch(n){$.post("errorLog.php","params="+n+"request- "+$("#quesform").find("input").serialize()+" response-"+encodeURIComponent(o)+"&qcode="+$("#qcode").val()+"&typeErrorLog=7",function(){})}if("normal"==t)try{if("undefined"!=typeof windowName&&"undefined"!=typeof responseArray.getWindowName&&windowName!=responseArray.getWindowName&&(setTryingToUnload(),window.location.href="newTab.php"),-14==responseArray.qcode)return hideSubmitNextButton(),alert(i18n.t("questionPage.exerciseComplete")),0==$("#ncertCompleted").length&&$("#question").before('<div id="ncertCompleted" style="margin: 0px auto !important; width: 350px; text-align: center; font-size: 14px; line-height: 22px;"><b style="color: #2FAC10;">'+i18n.t("questionPage.exerciseComplete")+'</b><br /><span style="cursor:pointer;" onclick="redirect_to_ncert_exercises();">Go to <u>NCERT Exercises</u></span></div><div style="clear:both;">&nbsp;</div>'),!1;if("diagnosticTestComplete"==responseArray.tmpMode){diagnosticTestComplete=1,$("#nextQuestion,#nextQuestion1,#nextQuestion2").hide();var r=responseArray.dataResponse,i=responseArray.alertText;return"Saved"!=r&&"nextcluster"!=r?(setTryingToUnload(),""!=i&&alert(i),window.location.href="controller.php?mode=startDiagnostic",!1):("nextcluster"==r?(""!=i&&alert(i),$("#mode").val("completeComprhensive")):""!=i&&alert(i),redirectDiagnostic(),!1)}if("NCERT"==responseArray.tmpMode){objNextQuestion=new Array;for(var a=responseArray.correctAnswer.split("##"),l=responseArray.quesType.split("##"),u=responseArray.dropdownAns.split("##"),c=responseArray.noOfBlanks.split("##"),d=responseArray.qcode.toString().split("##"),p=responseArray.dynamicQues.split("##"),m=responseArray.eeIcon.split("##"),g=0;g<d.length;g++)objNextQuestion.push(new QuestionObj({qcode:d[g],clusterCode:responseArray.clusterCode,noOfTrials:responseArray.noOfTrials,hintAvailable:responseArray.hintAvailable,quesType:l[g],correctAnswer:a[g],noOfBlanks:c[g],dropdownAns:u[g],dynamicQues:p[g],eeIcon:m[g],quesVoiceOver:responseArray.quesVoiceOver}));1==progressBarFlag&&($("#progress_bar_new").css("display","none"),$("#showProgressBar").css("display","none"))}else{try{objNextQuestion=new QuestionObj(responseArray)}catch(n){$.post("errorLog.php","params="+n+" response-"+encodeURIComponent(o)+"&qcode="+$("#qcode").val()+"&typeErrorLog=objNextQuestion",function(){})}condition=responseArray.condition.split("||"),action=responseArray.action.split("||"),noOfCondition=""!=responseArray.noOfCondition?responseArray.noOfCondition:0}if(progressBarFlag&&(sdlAttemptArr=responseArray.SDLAttempts,document.getElementById("totalSDLS").value=responseArray.totalSDLs,clusterAttemptArr=responseArray.clusterAttemptsArr,clusterNameAttemptArr=responseArray.clusterNameAttemptsArr,topicAttemptArr=responseArray.topicProgressStatus,clusterStatusPrompt=responseArray.clusterStatusPrompts,nameOfCluster=responseArray.clusterName,atHigherLevel=responseArray.higherLevel,$("#childClass").val()>3&&window.setTimeout(function(){showClusterPrompt()},500)),"undefined"!=typeof responseArray.topicRepeatAttempt&&"msAsStudent"!=userType&&window.setTimeout(function(){openTopicRepeatAttempt(responseArray.topicRepeatAttempt)},500),"mileStone1"==responseArray.badgeType?($("#prompt").css("height","1200px"),$("#sparkie").css("background-image",'url("assets/rewards/LevelZeroSparkies.png")'),$("#sparkie").css("height","56px"),$("#sparkie").css("width","44px"),$("#badge").css("background-image",'url("assets/rewards/LevelOneSparkie.png")'),$("#badge").css("width","112px"),$("#prompt").css("display","block"),$("#desc1").css("left","271px"),$("#desc2").css("left","277px"),$("#badge").css("left","338px"),$("#desc1").html(i18n.t("homePage.milestone1_1")),$("#desc2").html(i18n.t("homePage.milestone1_2")),$("#bottom_info1").html("Goodluck!"),$("#bottom_info2").css("display","none"),$("#sparkieImage").removeClass("level1"),$("#sparkieImage").addClass("level2")):"mileStone2"==responseArray.badgeType?($("#sparkie").css("background-image",'url("assets/rewards/Level1_L0.png")'),$("#sparkie").css("height","73px"),$("#sparkie").css("width","69px"),$("#sparkie").css("left","-3px"),$("#sparkie").css("top","43%"),$("#badge").css("background-image",'url("assets/rewards/LevelTwoSparkie.png")'),$("#badge").css("width","112px"),$("#prompt").css("display","block"),$("#desc1").css("left","271px"),$("#desc2").css("left","277px"),$("#badge").css("left","338px"),$("#desc1").html(i18n.t("homePage.milestone2_1")),$("#desc2").html(i18n.t("homePage.milestone2_2")),$("#bottom_info1").html("Goodluck!"),$("#bottom_info2").css("display","none"),$("#sparkieImage").removeClass("level2"),$("#sparkieImage").addClass("level3")):"mileStone3"==responseArray.badgeType?($("#sparkie").css("background-image",'url("assets/rewards/L.01_info.png")'),$("#sparkie").css("height","65px"),$("#sparkie").css("width","60px"),$("#badge").css("background-image",'url("assets/rewards/badgesRewardSection/Unlocked/Level1500.png")'),$("#badge").css("width","112px"),$("#prompt").css("display","block"),$("#desc1").css("left","271px"),$("#desc2").css("left","272px"),$("#badge").css("left","338px"),$("#desc1").html(i18n.t("homePage.milestone3_1")),$("#desc2").html(i18n.t("homePage.milestone3_2")),$("#bottom_info1").html("Goodluck!"),$("#bottom_info2").css("display","none"),$("#sparkieImage").removeClass("level2"),$("#sparkieImage").addClass("level3")):"boy"==responseArray.badgeType||"girl"==responseArray.badgeType?($("#badge").css("background-image",'url("assets/rewards/sparkies_notification.png")'),$("#badge").css("width","112px"),$("#prompt").css("display","block"),$("#desc1").css("left","271px"),$("#desc2").css("left","287px"),$("#badge").css("left","338px"),$("#desc1").html(i18n.t("homePage.theme2_1")),$("#desc2").html(i18n.t("homePage.theme2_2")),$("#bottom_info1").html("Well Done!"),$("#bottom_info2").html("Activate Theme?"),$("#bottom_info2").css("width","119px"),$("#bottom_info1").css("left","581px"),$("#bottom_info1").css("font-size","20px"),$("#bottom_info2").css("left","582px"),$("#bottom_info2").css("width","98px"),$("#bottom_info2").css("font-size","12px"),$("#bottom_info2").css("display","none")):("light"==responseArray.badgeType||"dark"==responseArray.badgeType)&&($("#badge").css("background-image",'url("assets/rewards/sparkies_notification.png")'),$("#badge").css("width","112px"),$("#prompt").css("display","block"),$("#desc1").css("left","271px"),$("#desc2").css("left","287px"),$("#badge").css("left","338px"),$("#desc1").html(i18n.t("homePage.theme1_1")),$("#desc2").html(i18n.t("homePage.theme1_2")),$("#bottom_info1").html("Well Done!"),$("#bottom_info2").html("Activate Theme?"),$("#bottom_info2").css("width","119px"),$("#bottom_info1").css("left","581px"),$("#bottom_info1").css("font-size","20px"),$("#bottom_info2").css("left","582px"),$("#bottom_info2").css("width","98px"),$("#bottom_info2").css("font-size","12px"),$("#bottom_info2").css("display","none")),document.getElementById("toughType").value=responseArray.isTough,document.getElementById("qcode").value=responseArray.qcode,document.getElementById("tmpMode").value=responseArray.tmpMode,document.getElementById("quesCategory").value=responseArray.quesCategory,document.getElementById("showAnswer").value=responseArray.showAnswer,document.getElementById("quesType").value=responseArray.quesType,document.getElementById("clusterCode").value=responseArray.clusterCode,document.getElementById("hasExpln").value=responseArray.hasExpln,responseArray.sdlList&&"normal"==responseArray.quesCategory){var h=$("#sdlList").val();if(""!=h){var f=h.split("|"),v=f.length;h=4==v?f[1]+"|"+f[2]+"|"+f[3]+"|"+responseArray.sdlList:h+"|"+responseArray.sdlList}else h=responseArray.sdlList;$("#sdlList").val(h)}if(Q1="",Q2="",Q4="",Q5="",Q6="",Q7="",Q8="",Q9="","undefined"!=typeof responseArray.Q1&&(Q1=responseArray.Q1),""!=Q1&&(document.getElementById("qno").value=Q1),"undefined"!=typeof responseArray.Q2&&(Q2=responseArray.Q2),"undefined"!=typeof responseArray.Q4&&(Q4=responseArray.Q4),"undefined"!=typeof responseArray.dispAns&&(Q5=responseArray.dispAns),"undefined"!=typeof responseArray.dispAnsA&&(Q6=responseArray.dispAnsA),"undefined"!=typeof responseArray.dispAnsB&&(Q7=responseArray.dispAnsB),"undefined"!=typeof responseArray.dispAnsC&&(Q8=responseArray.dispAnsC),"undefined"!=typeof responseArray.dispAnsD&&(Q9=responseArray.dispAnsD),footerBar=responseArray.footer,sparkie=responseArray.sparkie,voiceover1=responseArray.voiceover,hint1=responseArray.hint,hintAvailable1=responseArray.hintAvailable,document.getElementById("dynamicQues").value=responseArray.dynamicQues,document.getElementById("dynamicParams").value=responseArray.dynamicParams,preload1=responseArray.preloadDisplayAnswerImage,checkImage(preload1),problemid1=responseArray.problemid,ano=1,refreshProgessBar&&($(".yellow").remove(),$(".green").remove()),quesAttempted=responseArray.quesAttemptedInTopic,quesCorrect1=responseArray.quesCorrectInTopic,progressInTopic=responseArray.progressInTopic,lowerLevel1=responseArray.lowerLevel,(!progressBarFlag||refreshProgessBar)&&(refreshProgessBar=0,showProgressDetails(responseArray.quesAttemptedInTopic,responseArray.quesCorrectInTopic,responseArray.progressInTopic,responseArray.lowerLevel,1)),document.getElementById("noOfTrialsAllowed").value=responseArray.noOfTrials,totalAttempts=10,document.getElementById("nextQuesLoaded").value=1,$("#option"+responseArray.daUserAnswer+" .optionX").addClass("optionActive"),1==Q1&&0==$("#daInstructionPrompt").val()&&"daTest"==$("#quesCategory").val()){$("#daInstructionPrompt").val(1);{var y="<ul style='text-align:left'><li>The test duration is 30 minutes.</li><li>The timer will turn red when you will have 5 minutes remaining.</li><li>The test will be automatically submitted when 30 minutes are over.</li><li>You can click on any previously attempted question to recheck it.</li><li>All the questions that are answered will be considered for evaluation.</li></ul>";new Prompt({text:y,type:"alert",label2:"Continue Test",promptId:"SubmitTest",func1:function(){setTryingToUnload(),$("#prmptContainer_SubmitTest").remove()}})}}if(1==$("#DASubmitTestBtn").val()?($("#submittest").css("display","block"),$("#nextQuestion").hide()):$("#submittest").css("display","none"),$("#promptBox").css("width","650px"),$("#promptBox").css("margin-left","29%"),$("#promptBox").css("margin-top","175px"),Q1==$("#daTestQueCount").val()&&"daTest"==$("#quesCategory").val()&&($("#flagLater").css("display","none"),$("#nextQuestion").css("display","none"),$("#submittest").css("display","block"),$("#flagLater").css("display","block"),$("#DASubmitTestBtn").val(1)),"daTest"==$("#quesCategory").val())if(Q1>1){if(isDaFirstQue===!0){isDaFirstQue=!1;var w=parseInt($("#daTestQueCount").val())+1,b=w-Q1,y="Your Super Test on 'Decimals' is pending. <br><br> Questions left to be answered : "+b+"<br><br> Time remaining:   "+responseArray.DaTimeRemaining+" Minutes<br><br>Since you discontinued the test by ending the session, you cannot review and change answers for the questions attempted previously.";if(!$(".promptContainer").is(":visible")){new Prompt({text:y,type:"alert",label1:"Continue to Super Test",promptId:"specifyAnswer",func1:function(){jQuery("#prmptContainer_specifyAnswer").remove()}})}$("#promptBox").css("width","610px"),$("#promptBox").css("margin-left","28%"),$("#promptBox").css("margin-top","140px")}}else isDaFirstQue=!1}catch(n){$.post("errorLog.php","params="+n+" response-"+encodeURIComponent(o)+"&qcode="+$("#qcode").val()+"&typeErrorLog=8",function(){}),alert("1.3 Sorry! Could not fetch the next question. Redirecting to scorecard.\n\nGo to HOME page and click on CONTINUE."),document.getElementById("nextQuesLoaded").value="-1"}}else $.post("errorLog.php","params=request- "+encodeURIComponent($("#quesform").find("input").serialize())+"&qcode="+$("#qcode").val()+"&typeErrorLog=error 1.1",function(){}),alert("1.1: Oops! There seems to be a technical error. Error registered. End of session!"),document.getElementById("nextQuesLoaded").value="-1"},error:function(t,s,o){if(ajaxFailure){var n=!1;if(0==retryNo)var r="error 1.2.1";else var r="error 1.2";var i=$.ajax({url:"msPing.php",type:"POST",data:"",dataType:"text",async:!1});if(i.fail(function(){1>retryNo&&(n=!0),storageEnabled()&&localStorage.setItem("sessionID",$(".sessionColor:eq(0)").text()),storageEnabled()&&localStorage.setItem("qcode",$("#qcode").val()),storageEnabled()&&localStorage.setItem("qno",$(".sessionColor:eq(1)").text()),storageEnabled()&&localStorage.setItem("errorType","Ping fail"),alert(i18n.t("questionPage.slowLoadingMsg")),redirResult(8)}),n===!1){var a=$.ajax({url:"errorLog.php",type:"POST",data:"params="+JSON.stringify(t)+" - and - "+o+" - request- "+encodeURIComponent($("#quesform").find("input").serialize())+" retryNO - "+retryNo+"&qcode="+$("#qcode").val()+"&typeErrorLog="+r,dataType:"text",async:!1});a.fail(function(){n=!0,storageEnabled()&&localStorage.setItem("sessionID",$(".sessionColor:eq(0)").text()),storageEnabled()&&localStorage.setItem("qcode",$("#qcode").val()),storageEnabled()&&localStorage.setItem("qno",$(".sessionColor:eq(1)").text()),storageEnabled()&&localStorage.setItem("errorType","error 1.2")})}1>retryNo&&"NCERT"!=$("#quesCategory").val()?setTimeout(function(){retryNo++,e="qcode=0&mode=firstQuestion&quesCategory="+$("#quesCategory").val(),getNextQues(e,"normal")},4e3):n===!1&&(alert("1.2: Oops! There seems to be a technical error. End of session!"),document.getElementById("nextQuesLoaded").value="-1")}},complete:function(){window.status="Complete..."}}))}function fetchNextQues(){slowLoadTimer=setTimeout("showSlowLoadingMsg()",15e3),$("#wildcardMessage").text("").val(i18n.t("questionPage.placeHolderWildcardText")),prevQcodeAfterNext=prevQcode,prevQuesCategoryAfterNext=prevQuesCategory,stopHintTimer(),""!=$("#q1").html()?(prevQuesClone="",prevQuesHtml=$("#dlgAnswer").html(),prevQuesClone=$("#question").clone(),$("#commentOn2").attr("disabled",!1)):$("#commentOn2").attr("disabled",!0);$("#quesform").find("input").serialize();$("#quesform").attr("disabled",!0),$("#pnlQuestion").css("display","none"),$("#pnlAnswer").css("display","none"),$("#displayanswer").html(""),$("#questionType").css("display","none"),$("#q2").css("min-height","0px"),$(".groupQues").hide(),$(".groupQues").empty(),hideSubmitBar();var e=document.getElementById("info_bar").offsetHeight,t=window.innerHeight-e-80-17;$("#pnlLoading").css({display:"block",height:t}),isNextQuesLoaded()}function isNextQuesLoaded(){if("0"==$("#nextQuesLoaded").val())window.setTimeout("isNextQuesLoaded()",500);else if("-1"==$("#nextQuesLoaded").val())redirResult(9);else{$("#quesform").attr("disabled",!1);var e=$("#qcode").val();if(e=e.replace(/^\s*|\s*$/g,""),$("#refresh").val("0"),"-2"==e)return finalSubmit(e),!1;if("-3"==e)return finalSubmit(e),!1;if("-4"==e)alert("Error in finding minimum SDL"),finalSubmit(e);else{if("-5"==e||"-6"==e||"-7"==e)return finalSubmit(e),!1;if("-9"==e)return finalSubmit(e),!1;if("-10"==e)return showExerciseCompletion(),!1;if("-14"==e)return alert(i18n.t("questionPage.exerciseComplete")),0==$("#ncertCompleted").length&&$("#question").before('<div id="ncertCompleted" style="margin: 0px auto !important; width: 350px; text-align: center; font-size: 14px; line-height: 22px;"><b style="color: #2FAC10;">'+i18n.t("questionPage.exerciseComplete")+'</b><br /><span style="cursor:pointer;" onclick="redirect_to_ncert_exercises();">Go to <u>NCERT Exercises</u></span></div><div style="clear:both;">&nbsp;</div>'),!1;if("-11"==e){redirect=0;var t=document.getElementById("tmpMode").value,s=t.split("~");if("DCT"==s[0]){var o=document.createElement("form");o.setAttribute("method","post"),o.setAttribute("action","DCT.php");var n=document.createElement("input");n.setAttribute("type","hidden"),n.setAttribute("name","redirect"),n.setAttribute("value",s[1]),o.appendChild(n),document.body.appendChild(o),setTryingToUnload(),o.submit()}else{var r=document.getElementById("tmpMode").value,i=r.split("~"),a=i[0],l=i[1],o=document.createElement("form");o.setAttribute("method","post"),o.setAttribute("action","enrichmentModule.php");var n=document.createElement("input");if(n.setAttribute("type","hidden"),n.setAttribute("name","gameID"),n.setAttribute("value",a),o.appendChild(n),"undefined"!=typeof i[1]){var n=document.createElement("input");n.setAttribute("type","hidden"),n.setAttribute("name","gameCode"),n.setAttribute("value",l),o.appendChild(n)}var n=document.createElement("input");n.setAttribute("type","hidden"),n.setAttribute("name","gameMode"),n.setAttribute("value","DCTstage"),o.appendChild(n),document.body.appendChild(o),setTryingToUnload(),o.submit()}return!1}if("-13"==e)redirect=0,document.quesform.action="researchModule.php",setTryingToUnload(),document.quesform.submit();else{if("-16"==e)return finalSubmit(e),!1;var u=$("#tmpMode").val().replace(/^\s*|\s*$/g,"");if(u.indexOf("commoninstruction")>-1&&u.indexOf("groupInstruction")>-1)redirect=0,document.quesform.action="group_instruction.php",setTryingToUnload(),document.quesform.submit();else if(u.indexOf("commoninstruction")>-1&&u.indexOf("enrichmentModule")>-1){redirect=0;var n=document.createElement("input");n.setAttribute("type","hidden"),n.setAttribute("name","gameMode"),n.setAttribute("value","groupInstruction"),quesform.appendChild(n),document.quesform.action="enrichmentModule.php",setTryingToUnload(),document.quesform.submit()}else if("introVids"==u)redirect=0,document.quesform.action="introductionVideos.php",setTryingToUnload(),document.quesform.submit();else if("timedtest"==u)redirect=0,document.quesform.action="timedTest.php",setTryingToUnload(),document.quesform.submit();else{if("diagnosticTest"==u)return setTryingToUnload(),window.location.href="controller.php?mode=startDiagnostic",!1;if("-8"==e)return showClassLevelCompletion(),!1;"-12"==e?(redirect=0,document.getElementById("mode").value="ttSelection",document.quesform.action="controller.php?mode=ttSelection&completedPostTest=1",setTryingToUnload(),document.quesform.submit()):"game"==u?(redirect=0,document.getElementById("mode").value=u,document.quesform.action="controller.php",setTryingToUnload(),document.quesform.submit()):"remedial"==u?(redirect=0,document.quesform.action="remedialItem.php",setTryingToUnload(),document.quesform.submit()):(showNextQuestion(),progressBarFlag&&updateClusterBar())}}}}}function showNextQuestion(){if(document.getElementById("toughResult").value="NA",toughFlag=0,retryNo=0,"wildcard"==$("#quesCategory").val()&&$("#childClass").val()>3&&$("#wildcardMessage").css("display","block"),document.getElementById("ichar")&&(updateBuddy(2),$("#ichar").removeClass("buddyOpacity")),allowed=1,newQues=objNextQuestion,"NCERT"!=document.getElementById("tmpMode").value){if($("#q1").html(Q1),$("#lblQuestionNo").html(Q1),$("#lblQuestionNoCircle").html(Q1),$("#q2").html(Q2),"MCQ"==newQues.quesType.substring(0,3)?($("#pnlOptions").css("display","block"),"diagnosticTest"!=$("#quesCategory").val()?($("#pnlOptionTextA").html(newQues.optionA),$("#pnlOptionTextB").html(newQues.optionB)):($("#pnlOptionTextA").html(newQues.optionA[1]),$("#pnlOptionTextB").html(newQues.optionB[1]),optionDiagnosticArray.A=newQues.optionA[0],optionDiagnosticArray.B=newQues.optionB[0]),$("#optionC").css("display","none"),$("#optionD").css("display","none"),$("#optionC").removeClass("clear"),("MCQ-3"==newQues.quesType||"MCQ-4"==newQues.quesType)&&("diagnosticTest"!=$("#quesCategory").val()?$("#pnlOptionTextC").html(newQues.optionC):($("#pnlOptionTextC").html(newQues.optionC[1]),optionDiagnosticArray.C=newQues.optionC[0]),$("#optionC").css("display","block"),$("#optionD").css("display","none"),$(".option").css("width","30%"),$(".optionText").css("width","75%")),"MCQ-4"==newQues.quesType&&("diagnosticTest"!=$("#quesCategory").val()?$("#pnlOptionTextD").html(newQues.optionD):($("#pnlOptionTextD").html(newQues.optionD[1]),optionDiagnosticArray.D=newQues.optionD[0]),$("#optionD").css("display","block"),$("#optionC").addClass("clear"),$(".option").css("width","47%"),$(".optionText").css("width","80%")),"MCQ-2"==newQues.quesType&&($(".option").css("width","47%"),$(".optionText").css("width","80%"))):$("#pnlOptions").css("display","none"),$.trim($("#noOfSparkie").text())!=$.trim(sparkie)&&"0"!=$.trim($("#noOfSparkie").text())&&($("#noOfSparkie").removeAttr("style"),animateSparkie("noOfSparkie")),$.trim($("#sparkieInfo").text())!=$.trim(sparkie)&&"0"!=$.trim($("#noOfSparkie").text())&&($(".bubble").removeAttr("style"),animateSparkie("sparkieInfo")),""==sparkie)sparkie=0,parseInt($("#sparkieInfo").html())>0&&$("#childClass").val()<8?sparkie=parseInt($("#sparkieInfo").html()):parseInt($(".redCircle").html())>0&&$("#childClass").val()>=8&&(sparkie=parseInt($(".redCircle").html())),$("#noOfSparkie").html(sparkie),$("#sparkieInfo").html(sparkie),$(".redCircle").html(sparkie);else if($("#childClass").val()<8)parseInt(sparkie)<parseInt($("#sparkieInfo").html())||($("#noOfSparkie").html(sparkie),$("#sparkieInfo").html(sparkie));else if($("#childClass").val()>=8){var e=sparkie+":",t=e.split(":"),s=t[1].split("<");parseInt(s[0])<parseInt($(".redCircle").html())||$(".redCircle").html(s[0])}if($("#msAsStudentInfo").html(footerBar),1==voiceover1){if("undefined"!=typeof newQues.quesVoiceOver||""!=newQues.quesVoiceOver)var o=newQues.quesVoiceOver.split(".mp3")[0];document.getElementById("voiceover").innerHTML='<div id=voiceOverImage onclick="playVoiceover(\'Q\')" > </div><div class="audioControls"><audio controls="controls" class="soundFiles" preload="auto" id="one"><source src="'+o+'.mp3" type="audio/mpeg" /><source src="'+o+'.ogg" type="audio/ogg" />Your browser does not support the audio tag.</audio></div>',$("#quesStem").css("margin-top","-120px");var n=document.getElementById("one");n.load(),n.addEventListener("ended",voicePlayFinished)}if(document.getElementById("hintAvailable").value=hintAvailable1,$("#quesVoiceOver").val(newQues.quesVoiceOver),$("#ansVoiceOver").val(newQues.ansVoiceOver),$("#hintUsed").val(0),$("#timeTakenHints").val("0"),$("#userAllAnswers").val(""),""!=hint1){var r=hint1.split("||");$("#hintText1").html("<b>"+i18n.t("questionPage.hint")+" 1 - </b>"+r[0]),r[1]?$("#hintText2").html("<b>"+i18n.t("questionPage.hint")+" 2 - </b>"+r[1]):$("#bottomBtn").hide(),r[2]&&$("#hintText3").html("<b>"+i18n.t("questionPage.hint")+" 3 - </b>"+r[2]),r[3]&&$("#hintText4").html("<b>"+i18n.t("questionPage.hint")+" 4 - </b>"+r[3]),1==newQues.noOfTrialsAllowed&&("MCQ"==newQues.quesType.substring(0,3)&&startAnswerTimer(),$("#mainHint,#showHint").show())}document.getElementById("userResponse").value="",document.getElementById("eeResponse").value="",document.getElementById("noOfTrialsTaken").value=0,$(".question_text").contents().find("#q1").show();var i=newQues.quesType;"MCQ-2"!=i&&"MCQ-3"!=i&&"MCQ-4"!=i?(showSubmitButton(),$("#mcqText").hide()):"daTest"==$("#quesCategory").val()?($("#submit_bar").show(),document.getElementById("qno").value!=$("#daTestQueCount").val()&&0==$("#DASubmitTestBtn").val()&&$("#nextQuestion").show()):(showSubmitButton(),$("#skipQuestion").css("margin-top","-31px"),$("#submitQuestion").hide(),$("#submitQuestion2").hide(),$("#skipQuestion2").hide(),$("#mcqText").show()),$(".groupQues").empty(),"normal"==$("#quesCategory").val()?$("#emotToolBar").show():$("#emotToolBar").hide(),"1"==newQues.eeIcon?$("#eqEditorToggler").show():$("#eqEditorToggler").hide()}else{$("#pnlOptions").hide();var a=0;$("#eqEditorToggler").hide(),$("#question").contents().find("#q2").html(Q5),$("#q4:first").empty();{var l=hint1;$("#qcode").val().split("##")}$(".groupNav").removeClass("current"),$("#groupNav"+Q6).addClass("current"),$("#question").contents().find("#lblQuestionNoCircle").html(Q6);var u=Q1.split("##"),c=Q2.split("##"),d=Q4.split("##");if($.each(newQues,function(e){a++,d[e]=d[e].replace(/ansRadio/g,"ansRadio_"+newQues[e].qcode),$("#questionTemplate").contents().find("#q1").html(1==u.length?"":"("+u[e]+")"),$("#questionTemplate").contents().find("#q2").html(c[e]),"1"==newQues[e].eeIcon?$("#questionTemplate").contents().find(".eqEditorToggler").show():$("#questionTemplate").contents().find(".eqEditorToggler").hide(),$("#questionTemplate").contents().find("#q4").html(d[e]),$(".groupQues").append($("#questionTemplate").html()),a%parseInt(l)===0&&$(".groupQues").append('<div style="clear:both;">'),"NCERT"!=$("#tmpMode").val()&&(Q1=parseInt(Q1)+1)}),$(".groupQues .singleQuestion").addClass("column"+l),$(".groupQues").append('<div style="clear:both;">'),$("#msAsStudentInfo").html(footerBar),"NCERT"==$("#tmpMode").val()){var p=Q7.split("##");if($(".correct,.wrong").removeClass("correct").removeClass("wrong"),1==Q8){resultArr=Q9.split("##");var m=voiceover1,g=new Array;g=m.split("##")}$(".singleQuestion").each(function(e){if(1==Q8){var t=1==resultArr[e]?"correct":"wrong",s=1==resultArr[e]?"correctblank":"incorrectblank";3!=resultArr[e]&&($(this).contents().find("td:first div").addClass(t),$(this).find(".question input").addClass(s),$(this).find(".question select").addClass(s)),g[e]&&$(this).append(i18n.t("questionPage.correctAnswer")+": "+nAth(g[e]))}if(p[e]&&"@$*@"!=$.trim(p[e])){var o=p[e].split("[eeresponse]"),n=o[0].split("|"),r=o[1].split("@$*@data"),i=0;$(this).contents().find("select").each(function(){""!=$.trim(n[i])&&null!=n[i]&&"undefined"!=typeof n[i]&&$(this).find("option:contains('"+n[i]+"')").attr("selected",!0),i++,1==Q8&&$(this).attr("disabled","disabled")}),$(this).contents().find("input,iframe").each(function(){$(this).hasClass("openEnded")&&$(this).load(function(){$(this)[0].contentWindow.editable.innerHTML=r[0],$(this)[0].contentWindow.restoreImage("data"+r[1])}),"text"==$(this).attr("type")?($(this).val(n[i]),i++):"radio"==$(this).attr("type")&&$(this).val()==n[i]&&($(this).attr("checked",!0),i++),1==Q8&&$(this).attr("disabled","disabled")})}})}$(".groupQues").show(),"NCERT"!=$("#tmpMode").val()&&(Q1=parseInt(Q1)-1),document.getElementById("qno").value=Q1,"NCERT"==$("#tmpMode").val()&&1==Q8?hideSubmitBar():showSubmitButton();var h=1;$(".fracBox").each(function(){$(this).attr("id","fracB_"+h),$(this).next("input").attr("id","fracV_"+h),$(this).next().next("input").attr("id","fracS_"+h),h++})}(isIpad||isAndroid)&&(keypadPresent=1,attachKeypad("questions")),document.getElementById("problemid").value=problemid1,document.getElementById("subject")&&(document.getElementById("subject").value=problemid1),document.getElementById("pnlQuestion").style.display="",document.getElementById("noOfTrialsTaken").value=0,clearTimeout(slowLoadTimer),makeQuestionVisible(),document.getElementById("nextQuesLoaded").value=0,"challenge"==$("#quesCategory").val()&&($("#questionType").css("display","block"),$(".circle1").hide(),$("#questionImage").css("background","url('assets/lowerClass/challenge.png') no-repeat -2px 0"),$("#childClass").val()>=8&&$("#questionImage").css("background","url('assets/higherClass/challenge.png') no-repeat -2px 0"),$("#questionImage").click(function(){document.getElementById("b1")&&document.getElementById("b1").focus()}),$("#QT").html(i18n.t("questionPage.CQ"))),"wildcard"==$("#quesCategory").val()&&($("#questionType").css("display","block"),$(".circle1").hide(),$("#questionImage").css("background","url('assets/lowerClass/wildcard.png') no-repeat -2px 0"),$("#childClass").val()>=8&&$("#questionImage").css("background","url('assets/higherClass/wildcard.png') no-repeat -2px 0"),$("#questionImage").attr("title",i18n.t("questionPage.questionImageTitle")),$("#questionImage").click(function(){openWildcardInstruction()}),$("#questionType").css("cursor","pointer"),$("#QT").html(i18n.t("questionPage.wildCard"))),"challenge"==$("#quesCategory").val()||"wildcard"==$("#quesCategory").val()?1==infoClick?$("#topic_name").hide():"-80px"==$("#quesStem").css("margin-top")&&$("#quesStem").css("margin-top","-30px"):($("#topic_name").show(),$(".circle1").show(),"-30px"==$("#quesStem").css("margin-top")&&$("#quesStem").css("margin-top","-80px")),$("#pnlLoading").css("display","none"),$("#result").val(""),adjustScreenElements(),document.getElementById("questionText").scrollIntoView(1),$("#emotToolBar").contents().find("input:radio").removeAttr("disabled"),$("#emotToolBar").contents().find("input:radio").removeAttr("checked"),$("#emotToolBar").contents().find("label").removeClass("hoverClass"),"Blank"!=document.getElementById("quesType").value&&"D"!=document.getElementById("quesType").value&&"daTest"!=$("#quesCategory").val()&&showGlossary(document.getElementById("qcode").value,""),"diagnosticTest"==$("#quesCategory").val()&&($("#skipQuestion,#skipQuestion1,#skipQuestion2").css("display","block"),$("#skipQuestion,#skipQuestion1,#skipQuestion2").text("Don't know the answer"))
}function makeQuestionVisible(){if(document.getElementById("b1")?($(window).scrollTop(0),document.getElementById("b1").focus()):$(window).scrollTop(0),disableSubmitButton(),checkLoadingComplete(),""!=$("#quesVoiceOver").val()){var e=document.getElementById("one");e.load(),e.addEventListener("ended",voicePlayFinished)}document.onselectstart=function(){return!1},allowed=1;try{jsMath.Process(document)}catch(t){}}function submitAnswer(e){if("No Answer"==e){var t=$(".optionActive").text();t&&(e=t)}if(tryNo=1,$("#quesStem").css("height","auto"),"skipped"==e&&"diagnosticTest"!=$("#quesCategory").val()){var s=$("#qcode").val();if(skipQuestions.indexOf(s)<0)return!1}if(currentCluster=$("#clusterCode").val(),"diagnosticTest"==$("#quesCategory").val()&&"skipped"==e){$("#result").val(0),$("#mode").val("submitAnswer");var o=$("#quesform").find("input").serialize();return getNextQues(o,"normal"),$("#secsTaken").val(0),handleClose(),!1}if("skipped"==e){var n=3,r="skipped";return document.getElementById("userResponse").value=r,calcAns(n,newQues.quesType),handleClose(),!1}childCls=$("#childClass").val(),prevQcode=$("#qcode").val(),prevQno=$("#qno").val(),prevQuesCategory=$("#quesCategory").val(),submitCheck=1,hideCommentBox(),prevQuesCategory=$("#quesCategory").val(),allowed=0;try{if("NCERT"!=document.getElementById("tmpMode").value){if("MCQ"!=newQues.quesType.substring(0,3)&&$("#toughQuestionClick,#blackScreen").css("display","none"),disableSubmitButton(),"1"==newQues.eeIcon){var i="";try{i+=$("iframe.openEnded")[0].contentWindow.storeAnswer("")+"@$*@",i+=$("iframe.openEnded")[0].contentWindow.tools.save()}catch(a){}""!=i&&$("#eeResponse").val(i)}if("D"==newQues.quesType){for(var l=1,u=document.getElementsByTagName("select"),c=new Array,d=new Array,p=new Array,m=new Array,g=0;g<u.length;g++)"lstOpt"==u[g].id.substr(0,6)&&(c[u[g].id.substr(6)]=u[g].selectedIndex,d[u[g].id.substr(6)]=u[g].value,""==u[g].value&&(l=0));if(newQues.noOfBlanks>0)for(var h=new Array,f="",v="",y=0;y<newQues.noOfBlanks;y++){h[y]=!1;var w=y+1,b="b"+w;document.getElementById(b)?$("#"+b).hasClass("customfrac")?(f=document.getElementById("b"+w).value,h[g]=!0):f=document.getElementById(b).value:$("#fracB_"+w).hasClass("fracboxvalue")?(f=$("iframe#fracB_"+w)[0].contentWindow.getData(),h[y]=!0):f=$("iframe#fracB_"+w)[0].contentWindow.getData(),m.push(""==v?f:v),p.push(f)}var A="",T=c.join("|"),C=d.join("|"),k=p.join("|");if(0!=m.length)var A=m.join("|");else var A="";if(document.getElementById("userResponse").value=""!=k?""==A?C+"|"+k:C+"|"+A:C,l)var n=newQues.checkAnswerDropDown(T,k.split("|"),h);else var n=2;calcAns(n,newQues.quesType)}else if("Blank"==newQues.quesType){for(var Q=new Array,q=new Array,h=new Array,I=2,g=0;g<newQues.noOfBlanks;g++){var f="",v="";h[g]=!1,document.getElementById("b"+(g+1))?$("#b"+(g+1)).hasClass("customfrac")?(v=document.getElementById("b"+(g+1)).value,f=stripFrac(document.getElementById("b"+(g+1)).value),h[g]=!0):f=document.getElementById("b"+(g+1)).value:$("#fracB_"+(g+1)).hasClass("fracboxvalue")?(f=$("iframe#fracB_"+(g+1))[0].contentWindow.getData(),h[g]=!0):f=$("iframe#fracB_"+(g+1))[0].contentWindow.getData(),q.push(""==v?f:v),Q.push(f)}var x=0,E=0,r=Q.join("|");if(0!=q.length)var B=q.join("|");else var B="";document.getElementById("userResponse").value=""==B?r:B;var n=newQues.checkAnswerBlank(r.split("|"),h);if(noOfCondition>0)if(totalAttempts>0){var n=newQues.checkAnswerBlank(r.split("|"),h);if(0==totalAttempts)var n=newQues.checkAnswerBlank(r.split("|"),h);for(var S=1;3>=S;S++){var I=0;x=0;for(var g=0;noOfCondition>g;g++)if(parser.inputValues(r,ano),1==parser.parse(condition[g])){if(action1=action[g],E=/Mark Right/i.test(action1)?1:/Mark Wrong/i.test(action1)?2:3,E==S)if("Mark Right"==action1)n=1,calcAns(n,newQues.quesType),I=1;else if("Mark Wrong"==action1)n=0,calcAns(n,newQues.quesType),I=1;else if(-1!=action1.search(/Mark Right$/)){var P=action1.substring(7,action1.length-17);if(!$(".promptContainer").is(":visible")){new Prompt({text:P,type:"alert",promptId:"markRightCondition1",func1:function(){jQuery("#prmptContainer_markRightCondition1").remove()}})}n=1,calcAns(n,newQues.quesType),I=1}else{if(-1==action1.search(/Mark Wrong$/)){var P=action1.substring(7,action1.length-2);if(!$(".promptContainer").is(":visible")){new Prompt({text:P,type:"alert",promptId:"condition2",func1:function(){jQuery("#prmptContainer_condition2").remove()}})}I=1;break}var P=action1.substring(7,action1.length-17);if(!$(".promptContainer").is(":visible")){new Prompt({text:P,type:"alert",promptId:"markWrongCondition1",func1:function(){jQuery("#prmptContainer_markWrongCondition1").remove()}})}n=0,calcAns(n,newQues.quesType),I=1}allowCommonError=!1}else if(x++,x==noOfCondition&&(conCheck=1),1==conCheck){I=2;break}if(1==I)break}ano++,totalAttempts-=1}else I=2;if(""!=newQues.commonError.userAlert&&"undefined"!=typeof newQues.commonError.userAlert&&previousCommonError!=newQues.commonError.errorCode&&allowCommonError===!0){if(!$(".promptContainer").is(":visible")){new Prompt({text:newQues.commonError.userAlert,type:"alert",promptId:"commonError1",func1:function(){jQuery("#prmptContainer_commonError1").remove()}})}I=2,previousCommonError=newQues.commonError.errorCode,newQues.commonError=""}else 2==I&&(calcAns(n,newQues.quesType),previousCommonError="")}else if("I"!=newQues.quesType){if(""==document.getElementById("userResponse").value){stopAnswerTimer(),timeToAnswer=0,$(".optionX").removeClass("optionActive");var Q="";if(arguments.length>0)var Q=arguments[0];markOption(Q),"diagnosticTest"==$("#quesCategory").val()&&(Q=optionDiagnosticArray[Q]),document.getElementById("userResponse").value=Q,"daTest"==$("#quesCategory").val()?($("#"+prevQno+"box").hasClass("daPagingYellow")&&$("#daFlagCheck").attr("checked")&&$("#prevDAQuesFlag").val(1),$("#daFlagCheck").attr("checked",!1),$("#qno").val()!=$("#daTestQueCount").val()&&$("#DASubmitTestBetween").val(1),$("#daFlagCheck").is(":checked")&&(check="yes"),$("#qno").val()!=$("#daTestQueCount").val()?calcAns(newQues.checkAnswerMCQ(Q),newQues.quesType):saveDALastAnswer(),$("#nextDAQuesLoaded").val(1)):calcAns(newQues.checkAnswerMCQ(Q),newQues.quesType)}}else if("undefined"!=typeof $("#quesInteractive").attr("src")){var n="";try{var R=document.getElementById("quesInteractive"),_=R.contentWindow;_.postMessage("checkAnswer","*")}catch(a){alert("error in getting the response from interactive")}}else{var D=getFlashMovieObject("simplemovieQ"),n=D.GetVariable("answer");calcAns(n,newQues.quesType)}}else{document.getElementById("pnlQuestion").scrollIntoView(1),results=evalGroupAnswers();var F=voiceover1;if(0!=results){"NCERT"==$("#tmpMode").val()&&$(".current").removeClass("pending").addClass("complete"),allowed=1;var N=0;$("#quesform").attr("disabled",!1),$(".singleQuestion").each(function(){$(this).contents().find("input, select, textarea").each(function(){$(this).attr("disabled","disabled")})}),hideSubmitBar();var M=new Array;M=results.split("##");var H=new Array;H=F.split("##");var O=1;$(".singleQuestion").each(function(){N++;var e=1==M[N-1]?"correct":"wrong",t="correct"==e?"correctblank":"incorrectblank";if(3!=M[N-1]){if($(this).contents().find("td:first div").addClass(e),H[N-1]){$(this).append("<span id='ncertDispAns"+O+"'>"+i18n.t("questionPage.correctAnswer")+": "+nAth(H[N-1])+"</span>");try{jsMath.ProcessBeforeShowing(document.getElementById("ncertDispAns"+O))}catch(s){}}O++,$(this).find(".question input").addClass(t),$(this).find(".question select").addClass(t)}}),showNextButton(),$("#mode").val("submitAnswer"),$("#secsTaken").val(secs),$("#result").val(results);var o=$("#quesform").find("input").serialize();getNextQues(o,"normal")}}}catch(L){$.post("errorLog.php","params=JSerror-"+encodeURIComponent(JSerrors)+"error-"+L+" - "+$("#quesform").find("input").serialize()+"&qcode="+$("#qcode").val()+"&typeErrorLog=9",function(){})}if("daTest"==$("#quesCategory").val()){$("#pnlAnswer").hide();{$("#"+prevQno+"box").css("border-top-style"),$("#"+prevQno+"box").css("border-left-color")}$($("#userResponse").val()).addClass("optionActive"),$(".optionX").addClass("optionInactive"),$($("#userResponse").val()).removeClass("optionActive"),$("#userResponse").val(""),$("#nextQuesLoaded").val("0"),$("#qno").val()!=$("#daTestQueCount").val()&&handleClose()}}function setDaColorCode(e,t,s){1==$("#prevDAQuesFlag").val()&&"yes"==s&&($("#"+e+"box").removeClass("daPagingGrey"),$("#"+e+"box").addClass("daPagingYellow")),$("#"+t+"box").hasClass("daPagingYellow")&&($("#daFlagCheck").attr("checked",!0),$("#prevDAQuesFlag").val(1)),$("#"+t+"box").removeAttr("class"),$("#"+t+"box").addClass("daPagingBlue"),$("#"+t+"box").hasClass("daPagingYellow")?($("#daFlagCheck").attr("checked",!0),$("#prevDAQuesFlag").val(1)):$("#"+e+"box").hasClass("daPagingBlue")&&e!=t&&($("#"+e+"box").removeClass("daPagingBlue"),""!=$(".optionActive").text()?$("#"+e+"box").hasClass("daPagingYellow")||($("#"+e+"box").addClass("daPagingGrey"),$("#"+e+"box").css("cursor","pointer")):$("#"+e+"box").addClass("daPagingred")),$("#prevDAQuesFlag").val($("#daFlagCheck").attr("checked")?1:0)}function calcAns(e,t){trialTough=0,globalProcessResult=e,storageEnabled()&&localStorage.setItem("globalResult",globalProcessResult),globalProcessquesType=t;var s=document.getElementById("toughType").value;if(2==e){if(!$(".promptContainer").is(":visible")){new Prompt({text:i18n.t("questionPage.answerNotGivenMsg"),type:"alert",promptId:"specifyAnswer",func1:function(){jQuery("#prmptContainer_specifyAnswer").remove()}})}return enableSubmitButton(),allowed=1,$("#result").val(""),!1}if(toughQues="TOUGH"==s?1:0,1==toughQues&&0==toughDisabled){if(0==toughQuestionStatus){toughFlag=1,toughQuesInstances++;var o=localStorage.getItem("toughInstances");if(o=parseInt(o),storageEnabled()&&localStorage.setItem("toughInstances",parseInt(o)+1),toughQuesInstancesConsecutive++,(o+1>5||toughQuesInstancesConsecutive>3)&&(document.getElementById("toughCheck").style.display="block"),toughQuestionStatus++,document.getElementById("toughResult").value=e,0==giveResult)for(var n=newQues.noOfBlanks,r=0;n>r;r++)document.getElementById("b"+(r+1)).className="";return toughQuestionAlert(),!1}1==toughQuestionStatus1&&(trialTough=1,toughQuestionStatus1=0,$("#toughType").val("Tough Question"),"MCQ"==newQues.quesType.substring(0,3)&&($(".optionX").removeClass("optionActive"),$(".optionX").addClass("optionInactive"),$(".optionX").attr("disabled","true"),$(".optionX").removeAttr("disabled")),newQues.noOfTrialsAllowed++)}if(toughFlag||(toughQuesInstancesConsecutive=0),stopTheTimerTough(),document.getElementById("timeTakenToughQues").value=timeTakenToughAlert+"|"+timeTakenToughAttempt,timeTakenToughAttempt=0,"true"==localStorage.getItem("toughDisabled")&&(toughDisabled=1),!document.getElementById("spnQuesCorrectEC")||"normal"!=$("#quesCategory").val()||1!=e&&0!=e||(questionsDoneEC++,1==e&&quesCorrectEC++,$("#spnQuesCorrectEC").text(quesCorrectEC),$("#spnQuestionsDoneEC").text(questionsDoneEC)),$("#result").val(e),e>3)$.post("errorLog.php","params="+$("#quesform").find("input").serialize()+"&typeErrorLog=1",function(){});else{if(0==e&&newQues.noOfTrialsAllowed>1||newQues.noOfTrialsAllowed>1&&1==trialTough){document.getElementById("spnQuesCorrectEC")&&questionsDoneEC--;var i=parseInt(document.getElementById("noOfTrialsTaken").value);if(i++,i<newQues.noOfTrialsAllowed){if(document.getElementById("noOfTrialsTaken").value=i,$("#userAllAnswers").val($("#userAllAnswers").val()+$("#userResponse").val()+"$#@"),$("#result,#userResponse").val(""),0==noOfCondition&&1!=trialTough&&!$(".promptContainer").is(":visible")){new Prompt({text:i18n.t("questionPage.reviewMsg"),type:"alert",promptId:"toughQuestion",func1:function(){jQuery("#prmptContainer_toughQuestion").remove()}})}return"MCQ"==newQues.quesType.substring(0,3)&&$(".optionX").addClass("optionInactive"),0!=newQues.hintAvailable&&($("#mainHint").is(":visible")||$("#mainHint,#showHint").show(),$("#userResponse").val(""),$("#usefullHint").show()),enableSubmitButton(),allowed=1,!1}}if($("#hintUsed").val()>0)for(var a=newQues.hintAvailable,l=1;a>=l;l++)document.getElementById("hintText"+l)&&$("#hintText"+l).is(":visible")&&(timeTakenForAllHints=$("#timeTakenHints").val().split("||"),timeTakenForAllHints[l-1]=parseInt(timeTakenForAllHints[l-1])+timeTakenToViewHint,timeTakenForAllHintStr=timeTakenForAllHints.join("||"),$("#timeTakenHints").val(timeTakenForAllHintStr),stopHintTimer());$("#mainHint,.hintDiv,#showHint,#hintText2,#hintText3,#hintText4,#prevHint,#nextHint").attr("style",""),$("#showHint,#usefullHint").hide(),newAn(e,t,secs)}$("#secsTaken").val(secs),secs=0,$("#refresh").val("1"),$("#mode").val("submitAnswer");var u="";$("iframe.openEnded").length>0?(u+=$("iframe.openEnded")[0].contentWindow.storeAnswer("")+"@$*@",u+=$("iframe.openEnded")[0].contentWindow.tools.save()):u=$("iframe.constructionTool").length>0?$("iframe.constructionTool")[0].contentWindow.drawcode.getDrawnShapes():"NO_EE",$("#eeResponse").val(removeInvalidChars(u)),disableSubmitButton(),1==ipadVersionCheck&&$("#sideBar").css("height",$("#pnlQuestion").css("height"));var c=$("#quesform").find("input").serialize();""==$("#qcode").val()?($("#mode").val("nextAction"),document.quesform.action="controller.php",setTryingToUnload(),document.quesform.submit()):(getNextQues(c,"normal"),timeTakenAttemptArr[quesNoInFlow]=$("#secsTaken").val())}function newAn(e,t){for(var s,o=nAth(newQues.enA),n=0;7>n;n++)document.getElementById("b"+n)&&(document.getElementById("b"+n).disabled=!0),document.getElementById("fracB_"+n)&&jQuery("#fracB_"+n).removeAttr("contenteditable").attr("disabled","true");for(var r=document.getElementsByTagName("select"),n=0;n<r.length;n++)"lstOpt"==r[n].id.substr(0,6)&&(r[n].disabled=!0);var i=nAth(newQues.encryptedDispAns);if(1==e){var a=i18n.t("questionPage.correctMessages").split(","),l=Math.floor(Math.random()*a.length);s="","challenge"==$("#quesCategory").val()?s+=i18n.t("questionPage.CQCorrectMsg")+"<br/>":"wildcard"==$("#quesCategory").val()&&(s+=$("#childClass").val()<8||1==rewardSystem?i18n.t("questionPage.WildCardCorrectMsg")+"<br/>":i18n.t("questionPage.WildCardCorrectMsgReward")+"<br/>"),1==$("#hasExpln").val()&&(s+="<br/><b>"+i18n.t("questionPage.answerText")+": </b>"+i+"<br/><br/>"),$("#feedback_header_img").removeClass("ques_incorrect ").addClass("ques_correct"),$("#feedback_header").html(a[l]),$("#feedbackContainer_correct").removeClass("feedbackContainer_incorrect")}else if(0==e){var u="";if("MCQ-4"==t||"MCQ-3"==t||"MCQ-2"==t){tempResponse=$("#userResponse").val();var c=i18n.t("questionPage.osdaText",{userResponse:tempResponse});"A"==tempResponse&&""!=newQues.encryptedDispAnsA?u=nAth(newQues.encryptedDispAnsA):"B"==tempResponse&&""!=newQues.encryptedDispAnsB?u=nAth(newQues.encryptedDispAnsB):"C"==tempResponse&&""!=newQues.encryptedDispAnsC?u=nAth(newQues.encryptedDispAnsC):"D"==tempResponse&&""!=newQues.encryptedDispAnsD&&(u=nAth(newQues.encryptedDispAnsD)),u=""!=u?c+"("+i18n.t("questionPage.reason")+":"+u+")":c}if(s="","challenge"==$("#quesCategory").val()&&0==$("#showAnswer").val()&&(s+="<br/>"+i18n.t("questionPage.CQIncorrectFirstAttemptMsg")+"<br/>"),("normal"==$("#quesCategory").val()||"topicRevision"==$("#quesCategory").val()||"exercise"==$("#quesCategory").val()||"wildcard"==$("#quesCategory").val()||"challenge"==$("#quesCategory").val()&&1==$("#showAnswer").val())&&("wildcard"==$("#quesCategory").val()&&(s+=$("#childClass").val()<8||1==rewardSystem?"You missed a sparkie.<br>":"You missed 10 reward points.<br>"),s+=u+"<br>",s+=i18n.t("questionPage.correctAnswer"),"MCQ-4"!=t&&"MCQ-3"!=t&&"MCQ-2"!=t||trim(i)==o||(s+=" - <b>"+o+"</b>"),s+=": "+i),s+="<br><br>",$("#feedback_header_img").removeClass("ques_correct ").addClass("ques_incorrect"),$("#feedback_header").html(i18n.t("questionPage.QuesIncorrectMsg")),$("#feedbackContainer_correct").addClass("feedbackContainer_incorrect"),"D"==t){for(var d=document.getElementsByTagName("select"),p=new Array,m=0;m<d.length;m++)p[d[m].id.substr(6)]=d[m].selectedIndex;var o=nAth(newQues.encryptedDropDownAns);o=o.split("|");for(var n=0;n<o.length;n++)o[n]!=p[n]&&document.getElementById("spnOpt"+n)&&(document.getElementById("spnOpt"+n).style.color="red")}}s+=i18n.t("questionPage.nextQuesMsg")+"<br/><br/>",$("#displayanswer").html(s),document.getElementById("ichar")&&($("#ichar").addClass("buddyOpacity"),updateBuddy(e,frustrationMsg)),document.getElementById("pnlAnswer").style.display="none";try{jsMath.ProcessBeforeShowing(document.getElementById("displayanswer"))}catch(g){}showNextButton(),animateAnswerBox(),allowed=1}function evalGroupAnswers(){var e,t=newQues.length,s=new Array,o="",n=new Array,r=new Array,i=new Array,a=new Array,l=new Array,u=new Array,c=new Array,d=0;if("undefined"!=typeof Q1)var p=Q1.split("##");else var p=new Array;$(".singleQuestion").each(function(){if(d++,e=0,c[d-1]=new Array,!(d>t)){var s="",o="",l="",p="",m="";$(this).contents().find("select").each(function(){l+=$(this).prop("selectedIndex")+"|",p+=$(this).val()+"|"}),$(this).contents().find("input,iframe").each(function(){if(c[d-1][e]=!1,$(this).hasClass("openEnded"))m+=$(this)[0].contentWindow.storeAnswer("")+"@$*@",m+=$(this)[0].contentWindow.tools.save()+"@$*@";else if("text"==$(this).attr("type"))$(this).hasClass("customfrac")?(s+=stripFrac($(this).val())+"|",o+=$(this).val()+"|",c[d-1][e]=!0,e++):(s+=$(this).val()+"|",o+=$(this).val()+"|");else if($(this).hasClass("fracBox")){var t=$(this).attr("id");$("#"+t).hasClass("fracboxvalue")?(s+=$("iframe#"+t)[0].contentWindow.getData()+"|",o+=$("iframe#"+t)[0].contentWindow.getData()+"|",c[d-1][e]=!0,e++):(s+=$(this).val()+"|",o+=$("iframe#"+t)[0].contentWindow.getData()+"|"),t.split("_")[1]&&jQuery("#fracB_"+t.split("_")[1]).removeAttr("contenteditable")}else"radio"==$(this).attr("type")&&$(this).is(":checked")&&(s+=$(this).val()+"|",o+=$(this).val()+"|")}),s=s.substring(0,s.length-1),o=o.substring(0,o.length-1),m=m.substring(0,m.length-1),l=l.substring(0,l.length-1),p=p.substring(0,p.length-1),n.push(s),r.push(o),u.push(removeInvalidChars(m)),i.push(l),a.push(p)}});for(var m=0;t>m;m++){if("D"==newQues[m].quesType){var g=newQues[m].checkAnswerDropDown(i[m],n[m].split("|"),c[m]),h=a[m];""!=r[m]&&(h+="|"+r[m])}else if("Open Ended"==newQues[m].quesType)var g=newQues[m].checkAnswerOpenEnded(u[m]);else if("Blank"==newQues[m].quesType)var g=newQues[m].checkAnswerBlank(n[m].split("|"),c[m]),h=r[m];else var g=newQues[m].checkAnswerMCQ(n[m]),h=n[m];2==g&&s.push(p[m]),o+=g+"##",l.push(h)}if($("input[type=text]").removeClass("incorrectblank"),$("input[type=text]").removeClass("correctblank"),0==s.length){var f=l.join("##");return $("#userResponse").val(f),$("#eeResponse").val(u.join("##")),o}var v=s.join(",");if(1==p.length){if(!$(".promptContainer").is(":visible")){new Prompt({text:i18n.t("questionPage.ncertOneAnswer"),type:"alert",promptId:"specifyAnswerNcertQ1",func1:function(){jQuery("#prmptContainer_specifyAnswerNcertQ1").remove()}})}}else if(!$(".promptContainer").is(":visible")){new Prompt({text:i18n.t("questionPage.ncertAllAnswer")+v+".",type:"alert",promptId:"specifyAnswerNcertQM",func1:function(){jQuery("#prmptContainer_specifyAnswerNcertQM").remove()}})}return!1}function daFlagHandle(e){var t=$("#qno").val();if($("#daFlagCheck").attr("checked"))var s=1;else s=0,e="no";var o=$(".optionActive").text(),n=$("#qcode").val(),r=o;""==r&&(r="No Answer");var i=newQues.checkAnswerMCQ(r);$.ajax("controller.php",{type:"post",data:"mode=saveDaFlag&qno="+t+"&qcode="+n+"&ans="+r+"&result="+i+"&isflag="+s,success:function(){$("#pnlAnswer").css("display","none"),$("#displayanswer").html(""),"yes"==e?($("#"+t+"box").css("cursor","pointer"),$("#"+t+"box").removeClass("daPagingGrey"),$("#"+t+"box").removeClass("daPagingred"),$("#"+t+"box").removeClass("daPagingBlue"),$("#"+t+"box").addClass("daPagingYellow"),$("#prevDAQuesFlag").val(1)):($("#daFlagCheck").attr("checked",!1),$("#prevDAQuesFlag").val(0),$("#"+t+"box").removeClass("daPagingYellow"),$("#"+t+"box").addClass("daPagingBlue"))}})}function saveDALastAnswer(){var e=$("#qno").val(),t=$(".optionActive").text(),s=$("#qcode").val(),o="",n=newQues.checkAnswerMCQ(t);o=t?t:"No Answer",$.ajax("controller.php",{type:"post",data:"mode=saveDaLastAnswer&qno="+e+"&qcode="+s+"&ans="+o+"&result="+n,success:function(){($("#"+e+"box").hasClass("daPagingYellow")||1==$("#prevDAQuesFlag").val())&&$("#daFlagCheck").attr("checked",!0)}})}function handleClose(){var e=0;if("daTest"==$("#quesCategory").val()&&($("#qno").val()==$("#daTestQueCount").val()||1==$("#DASubmitTestBtn").val()&&0==$("#DASubmitTestBetween").val())){var t=$("#qno").val(),s=$("#countdown").html(),o=s.split(" ");if(!$(".promptContainer").is(":visible")){new Prompt({text:i18n.t("questionPage.daTestSubmitMssg"),type:"confirm",label1:"Yes",label2:"No",promptId:"SubmitTest",func1:function(){var e=$(".optionActive").text();submitAnswer(e?e:"No Answer"),setTryingToUnload(),jQuery("#prmptContainer_SubmitTest").remove(),$.ajax("controller.php",{type:"post",data:"mode=endDaTest&qno="+t+"&time="+o[0]+"&status=3&response="+e,success:function(e){resp=e,setTryingToUnload(),window.location.assign("da_feedbackForm.php")}})},func2:function(){$("#prmptContainer_SubmitTest").remove()}})}return!1}if("daTest"==$("#quesCategory").val()){var n=$(".optionActive").text();$("#qno").val()!=$("#daTestQueCount").val()&&1!=$("#nextDAQuesLoaded").val()&&(n?submitAnswer(n):(submitAnswer("No Answer"),e=1));var r=parseInt($("#qno").val()),i=r+1;setDaColorCode(r,i,"yes"),$("#DASubmitTestBetween").val(0)}if(1==diagnosticTestComplete)return $("#nextQuestion,#nextQuestion1,#nextQuestion2").show(),!1;$("#toolContainer,#radioButtons,.questionPrompts").attr("style",""),$("#radioButtons").css("position","relative"),noSubmit=0,giveResult=0,toughQuestionStatus=0,submitCheck=0,qq=0,toolClick=1,$("#wildcardMessage").css("display","none"),"msAsStudent"==userType&&($("#msAsStudentInfo").css("right","0px"),$("#msAsStudentInfo").css("left",""),$("#msAsStudentInfo").css("top","215px")),$("#skipQuestion").css("margin-top","23px"),document.getElementById("promptNo").value=0,1==toolClick&&toolbar(),$(".optionX").removeClass("optionActive"),$("#cc").attr("class","emotImage comment_new"),$(".optionX").addClass("optionInactive");try{if(stop1(),""==$("#result").val())return}catch(a){}hideCommentBox(),window.status="",plstart=new Date,stopTheTimer();var l=$("#wildcardMessage").val().trim();l==i18n.t("questionPage.placeHolderWildcardText")&&(l=""),timeTakenExplainationArr[quesNoInFlow]=secs,sparkieForExplaination()&&"diagnosticTest"!=$("#quesCategory").val()&&(sparkieCount=1,$("#sparkieInfo").html(parseInt($("#sparkieInfo").text())+1),$("#noOfSparkie").html(parseInt($("#noOfSparkie").text()+1)),$(".redCircle").text(parseInt($(".redCircle").text())+1)),"diagnosticTest"!=$("#quesCategory").val()&&"daTest"!=$("#quesCategory").val()&&updateTimeTakenForExpln(secs,l),modifyDOMforPC(),fetchNextQues(),saveEmotByAjax(emotID),emotID=""}function updateTimeTakenForExpln(e,t){$("#submit_bar1").is(":visible")?$("#nextQuestion1").hide():$("#submit_bar").is(":visible")?$("#nextQuestion").hide():$("#menuBar").is(":visible")&&($("#nextQuestion2").hide(),$("#submitQuestion2").hide(),$("#skipQuestion2").hide());var s="mode=timeTakenForExpln";s+="&timeTaken="+e,s+="&qcode="+prevQcode,s+="&question_type="+prevQuesCategory,s+="&quesCategory="+$("#quesCategory").val(),s+="&sparkieExplaination="+sparkieCount,sparkieCount=0,t!=i18n.t("questionPage.placeHolderWildcardText")&&""!=t&&"questionPage.placeHolderWildcardText"!=t&&(s+="&wildCardText="+t);try{$.ajax("controller.php",{type:"post",data:s,success:function(){}})}catch(o){alert("updateTimeTakenForExpln "+o.description)}}function modifyDOMforPC(){$(".singleQuestion").each(function(){$(this).contents().find(".correct").removeClass("correct"),$(this).contents().find(".wrong").removeClass("wrong")})}function removeInvalidChars(e){return e=escape(e),e=e.replace(/%D7/g,"&times;"),e=e.replace(/%F7/g,"&divide;"),e=e.replace(/%AB/g,"&laquo;"),e=e.replace(/%B0/g,"&deg;"),e=e.replace(/%BB/g,"&raquo;"),e=e.replace(/%u2220/g,"&ang;"),e=e.replace(/%u03B1/g,"&alpha;"),e=e.replace(/%u03B2/g,"&beta;"),e=e.replace(/%u03B3/g,"&gamma;"),e=e.replace(/%u0394/g,"&Delta;"),e=e.replace(/%u03BB/g,"&lambda;"),e=e.replace(/%u03B8/g,"&theta;"),e=e.replace(/%u03C0/g,"&pi;"),e=e.replace(/%u2211/g,"&sum;"),e=e.replace(/%u221A/g,"&#8730;"),e=e.replace(/%u221B/g,"&#8731;"),e=e.replace(/%BB/g,"&raquo;"),e=e.replace(/%AB/g,"&laquo;"),e=e.replace(/%F7/g,"&divide;"),e=e.replace(/%D7/g,"&times;"),e=e.replace(/%u2264/g,"&le;"),e=e.replace(/%u2265/g,"&ge;"),e=e.replace(/%u22A5/g,"&perp;"),e=e.replace(/%u03B4/g,"&delta;"),e=e.replace(/%u03C3/g,"&sigma;"),e=e.replace(/%u2282/g,"&sub;"),e=e.replace(/%u2284/g,"&#8836;"),e=e.replace(/%u2245/g,"&cong;"),e=e.replace(/%u2260/g,"&ne;"),e=e.replace(/%u2208/g,"&#8712;"),e=e.replace(/%u2209/g,"&#8713;"),e=e.replace(/%u222A/g,"&#8746;"),e=e.replace(/%u2229/g,"&#8745;"),e=e.replace(/%u223C/g,"&#8764;"),e=e.replace(/%B1/g,"&plusmn;"),e=e.replace(/%u2234/g,"&there4;"),e=unescape(e)}function nAth(e){var t=e.split("-"),s=t.length;decrypted_message="";for(var o=0;s>o;o++)ascii_num_byte_to_decrypt=t[o],ascii_num_byte_to_decrypt/=2,ascii_num_byte_to_decrypt-=5,decrypted_byte=String.fromCharCode(ascii_num_byte_to_decrypt),decrypted_message+=decrypted_byte;return decrypted_message}function CheckIfNumeric(e){if(e=e?e:window.event,/Firefox/.test(window.navigator.userAgent)&&0!=e.keyCode)return!0;var t=e.which?e.which:e.keyCode;if(t>31&&46!=t&&47!=t&&45!=t&&(48>t||t>57)||45==t&&(0!=e.target.selectionStart||e.target.value.indexOf("-")>=0)||46==t&&e.target.value.indexOf(".")>=0||47==t&&(0==e.target.selectionStart||e.target.value.indexOf("/")>=0)){if(!keypadPresent&&!$(".promptContainer").is(":visible")){new Prompt({text:"Please enter only numbers.",type:"alert",promptId:"numberValidation",func1:function(){jQuery("#prmptContainer_numberValidation").remove()}})}return!1}return!0}function showProgressDetails(e,t,s,o,n){if(""==e&&(e=0),""==t&&(t=0),""==s&&(s=0),""==o&&(o=0),!progressBarFlag){var r=360*s/100;$(".pie").css({"-webkit-transform":"rotate("+r+"deg)","-moz-transform":"rotate("+r+"deg)","-o-transform":"rotate("+r+"deg)",transform:"rotate("+r+"deg)","-ms-transform":"rotate("+r+"deg)"}),180>r&&($("#pieSlice2").attr("class","hold1"),$("#pieSlice2").css({"-webkit-transform":"rotate("+(180-r)+"deg)","-moz-transform":"rotate("+(180-r)+"deg)","-o-transform":"rotate("+(180-r)+"deg)",transform:"rotate("+(180-r)+"deg)","-ms-transform":"rotate("+(180-r)+"deg)"}),$(".pie").css({"-webkit-transform":"rotate(180deg)","-moz-transform":"rotate(180deg)","-o-transform":"rotate(180deg)",transform:"rotate(180deg)","-ms-transform":"rotate(180deg)"}))}$("#spnProgress").html(s+"%"),$("#spnProgress1").html(s+"%"),$("#spnProgressNew").html(s+"%"),$("#spnQuestionsDone").html(e),$("#spnQuesCorrect").html(t),document.getElementById("green")&&(document.getElementById("green").style.width=s+"%"),progressBarFlag&&n||document.getElementById("green")&&(document.getElementById("green").style.width=s+"%")}function remakeProgressBar(){var e=0,t=0,s=0,o=$("#totalSDLS").val(),n=$("#progress_bar_new").width(),r=Math.round(n-1)/o,i={};divBar=document.getElementById("yellowBars"),$.each(sdlAttemptArr,function(o){var n=document.createElement("div");n.id="yellow_"+o,n.className="hidden",n.className="yellow",n.style.width=r+"px",$(n).attr("sdl",o),"daTest"!=$("#quesCategory").val()&&divBar.appendChild(n),n.style.backgroundColor=4==parseInt(sdlAttemptArr[o])?"white":1==parseInt(sdlAttemptArr[o])?"#9ec956":0==parseInt(sdlAttemptArr[o])?"#e75903":5==parseInt(sdlAttemptArr[o])?"#fbd212":2==parseInt(sdlAttemptArr[o])||3==parseInt(sdlAttemptArr[o])?"#e75903":"white",0==t&&(t=o),s=o,e=o}),$("#progress_text_new").html(nameOfCluster),$("#progress_text_new").text().length>40&&$("#progress_text_new").html($("#progress_text_new").text().slice(0,40)+"...");var a=0;$.each(clusterAttemptArr,function(e){"activity"!=clusterAttemptArr[e][2]&&"timedTest"!=clusterAttemptArr[e][2]&&a++});{var l=a,n=386;Math.round(n)/l}divBar=document.getElementById("greenBars");var u=0,c="",a=0,d=0;$.each(clusterAttemptArr,function(e){var t=document.createElement("div");"activity"!=clusterAttemptArr[e][2]&&"timedTest"!=clusterAttemptArr[e][2]?(t.id="green_"+e,t.className="hidden",t.className="green",t.style.width=clusterAttemptArr[e][3]*n+"px",t.style.backgroundColor="white",t.title=clusterNameAttemptArr[clusterAttemptArr[e][0]],a++,d+=clusterAttemptArr[e][3]*n):"activity"==clusterAttemptArr[e][2]?(t.id="green_"+e,t.className="hidden",t.className="activityTTIcons activityIcon",t.style.left=d-10+"px",t.title=clusterAttemptArr[e][1],"attempted"==clusterAttemptArr[e][3]&&(t.className="activityTTIcons activityIcon_attempted")):"timedTest"==clusterAttemptArr[e][2]&&(t.id="green_"+e,t.className="hidden",t.className="activityTTIcons timedTestIcon",t.style.left=d-10+"px",t.title=clusterAttemptArr[e][1],"passed"==clusterAttemptArr[e][3]?t.className="activityTTIcons timedTestIcon_passed":"failed"==clusterAttemptArr[e][3]&&(t.className="activityTTIcons timedTestIcon_failed"),"activity"==clusterAttemptArr[e-1][2]&&(t.style.top="-48px"),"timedTest"==clusterAttemptArr[e-1][2]&&(t.style.top="-48px")),divBar.appendChild(t),$(t).attr("cluster",clusterAttemptArr[e][0]),i[clusterAttemptArr[e][0]]=new Array;for(var s=topicAttemptArr.indexOf(clusterAttemptArr[e][0]);-1!=s;)i[clusterAttemptArr[e][0]].push(s),s=topicAttemptArr.indexOf(clusterAttemptArr[e][0],s+1);for(var o=0;o<i[clusterAttemptArr[e][0]].length;o++){if("SKIPPED"==topicAttemptArr[i[clusterAttemptArr[e][0]][o]+2]){t.style.backgroundColor="#2f99cb",o=i[clusterAttemptArr[e][0]].length;break}if("SUCCESS"==topicAttemptArr[i[clusterAttemptArr[e][0]][o]+2]){t.style.backgroundColor="#9ec956",o=i[clusterAttemptArr[e][0]].length;break}null==topicAttemptArr[i[clusterAttemptArr[e][0]][o]+2]||""==topicAttemptArr[i[clusterAttemptArr[e][0]][o]+2]?1==topicAttemptArr[i[clusterAttemptArr[e][0]][o]+1]?t.style.backgroundColor="#fbd212":(t.style.backgroundColor="#orange",c=clusterAttemptArr[e][0]):"FAILURE"==topicAttemptArr[i[clusterAttemptArr[e][0]][o]+2]&&(topicAttemptArr[i[clusterAttemptArr[e][0]][o]+1]>=4?t.style.backgroundColor="#e75903":(t.style.backgroundColor="orange",c=clusterAttemptArr[e][0]))}clusterAttemptArr[e][0]==$("#clusterCode").val()&&(u=1,t.style.height="25px",t.style.marginTop="-5px","orange"==t.style.backgroundColor&&(backToRemediationCluster=1))}),$("#topicProgressBar").css("width",n+"px"),0==u&&1!=atHigherLevel&&$("div[cluster="+c+"]").css({height:"25px","margin-top":"-5px"})}function showClusterPrompt(){var e="";$.each(clusterAttemptArr,function(t){"activity"!=clusterAttemptArr[t][2]&&"timedTest"!=clusterAttemptArr[t][2]&&(e=clusterAttemptArr[t][0])}),2==clusterStatusPrompt&&currentCluster!=e?(clusterStatusPromptfn(),$("#clusterStatusPrompts").html(i18n.t("questionPage.clusterStatusPrompt2")),clusterStatusPrompt=0,noSubmit=1):1==clusterStatusPrompt?(clusterStatusPromptfn(),$("#clusterStatusPrompts").html($("#childNm").val()+i18n.t("questionPage.clusterStatusPrompt1")),clusterStatusPrompt=0,noSubmit=1):3==clusterStatusPrompt?(clusterStatusPromptfn(),$("#clusterStatusPrompts").html($("#childNm").val()+i18n.t("questionPage.clusterStatusPrompt3")),clusterStatusPrompt=0,noSubmit=1):5==clusterStatusPrompt&&currentCluster!=e?(clusterStatusPromptfn(),$("#clusterStatusPrompts").html("Good progress "+$("#childNm").val()+i18n.t("questionPage.clusterStatusPrompt0")),clusterStatusPrompt=0,noSubmit=1):4==clusterStatusPrompt&&1==backToRemediationCluster&&(clusterStatusPromptfn(),$("#clusterStatusPrompts").html($("#childNm").val()+i18n.t("questionPage.clusterStatusPrompt4")),backToRemediationCluster=0,clusterStatusPrompt=0,noSubmit=1)}function updateClusterBar(){previousCluster!=$("#clusterCode").val()&&"challenge"!=$("#quesCategory").val()&&"daTest"!=$("#quesCategory").val()&&($(".green,.yellow").remove(),remakeProgressBar()),previousCluster=$("#clusterCode").val();var e=0;showProgressDetails(quesAttempted,quesCorrect1,progressInTopic,lowerLevel1,0),$.each(sdlAttemptArr,function(t){divs=document.getElementById("yellow_"+t),5==parseInt(sdlAttemptArr[t])?("rgb(251, 210, 18)"!=$('div[sdl="'+t+'"]').css("background-color")&&"rgb(255, 255, 255)"!=$('div[sdl="'+t+'"]').css("background-color")&&($(".green,.yellow").remove(),$(".yellow").css("background-color","white"),remakeProgressBar()),$('div[sdl="'+t+'"]').css("background-color","#fbd212")):1==parseInt(sdlAttemptArr[t])&&"daTest"!=$("#quesCategory").val()?divs.style.backgroundColor="#9ec956":0==parseInt(sdlAttemptArr[t])&&"daTest"!=$("#quesCategory").val()?divs.style.backgroundColor="#e75903":2==parseInt(sdlAttemptArr[t])||3==parseInt(sdlAttemptArr[t])&&"daTest"!=$("#quesCategory").val()?divs.style.backgroundColor="#e75903":"daTest"!=$("#quesCategory").val()&&(divs.style.backgroundColor="white"),e=t,lastKey=t
})}function finalSubmit(e){if($("#mode").val(e),1==e||-5==e||6==e||-6==e||-7==e||-9==e){$("#endSessionClick").height(175),$(".button1").hide(),$(".endSessionText").css("display","none"),$("#loading").show(),$("#loadingImage").show();var t="mode=endsession";t+="&code="+e;try{{$.ajax("controller.php",{type:"post",data:t,success:function(e){resp=e,redirResult(0)},error:function(){}})}}catch(s){alert("Final Submit "+s.description)}}else redirResult(0)}function redirResult(e){redirect=0,document.quesform.action="topicRevision"==$("#quesCategory").val()?"topicRevisionReport.php?endType="+e:"exercise"==$("#quesCategory").val()?"exerciseSessionReport.php?endType="+e:"NCERT"==$("#quesCategory").val()||"NCERT REPORT"==$("#quesCategory").val()?"msAsStudent"==userType?"home.php":"homeworkSelection.php?endType="+e:"msAsStudentNCERT"==$("#quesCategory").val()?"home.php":"endSessionReport.php?endType="+e,setTryingToUnload(),document.quesform.submit()}function showSlowLoadingMsg(){clearTimeout(slowLoadTimer);var e=$.ajax({url:"errorLog.php",type:"POST",data:"params=request- "+$("#quesform").find("input").serialize()+" error-"+encodeURIComponent(JSerrors)+" ajaxFailure - "+ajaxFailure+" , responseArray - "+responseArray+",&qcode="+$("#qcode").val()+"&typeErrorLog=slow internet",dataType:"text",async:!1});ajaxFailure=!1,e.fail(function(){storageEnabled()&&localStorage.setItem("sessionID",$(".sessionColor:eq(0)").text()),storageEnabled()&&localStorage.setItem("qcode",$("#qcode").val()),storageEnabled()&&localStorage.setItem("qno",$(".sessionColor:eq(1)").text()),storageEnabled()&&localStorage.setItem("errorType","error 1")}),alert(i18n.t("questionPage.slowLoadingMsg")),redirResult(8)}function endtopic(){$("#endTopic,#blackScreen").css("display","block")}function changeTopic(){redirect=0,$("#mode").val("topicSwitch"),$("#quesform").attr("action","controller.php"),setTryingToUnload(),document.forms[0].submit()}function daSessionExpire(){var e="Your time is out. The system has auto- submitted your test. Please give us a feedback to continue to the results.";if(!$(".promptContainer").is(":visible")){new Prompt({text:e,type:"alert",label1:"Continue to Home page",promptId:"specifyAnswer",func1:function(){$.ajax("controller.php",{type:"post",data:"mode=endDaTest&qno="+$("#qno").val()+"&status=3",success:function(e){resp=e,setTryingToUnload(),window.location.assign("home.php")}})}})}}function endsession(){if("daTest"==$("#quesCategory").val()){$("#qDAQuesPromptLoad").val(1);{var e=$("#qno").val(),t=$("#countdown").html(),s=t.split(" "),o=$(".optionActive").text(),n="You are ending the session in between the test. In that case, you will not be allowed to review the flagged questions. Also, you cannot change the previously answered questions.";new Prompt({text:n,type:"confirm",label2:"Continue the Super Test",label1:"End Session, anyway!",func1:function(){$.ajax("controller.php",{type:"post",data:"mode=endDaTest&qno="+e+"&time="+s[0]+"&status=2&response="+o,success:function(e){resp=e,setTryingToUnload(),window.location.assign("home.php")}})},func2:function(){$("#prmptContainer_createCustom").remove()},promptId:"createCustom"})}$("#promptBox").css("width","610px"),$("#promptBox").css("margin-left","31%"),$("#promptBox").css("margin-top","180px")}else $("#endSessionClick,#blackScreen").css("display","block")}function toughQuestionAlert(){timeTakenToughAlert=0,startTheTimerToughAlert(),disableEnableBoxes(!0),$("#submitQuestion").css("display","none"),$("#skipQuestion").css("display","none"),$("#submitQuestion2").css("display","none"),$("#skipQuestion2").css("display","none"),isAndroid&&isChrome?toughQuestionJsAlert():$("#toughQuestionClick,#blackScreen").css("display","block"),giveResult=1,noSubmit=1}function toughQuestionJsAlert(){confirm(i18n.t("questionPage.toughQuestionText").replace(/<br>/g,"\n"))?cancelToughQuestionAlert():submitToughQuestionAlert()}function cancelToughQuestionAlert(){storageEnabled()&&localStorage.setItem("toughDisabled",document.getElementById("dontShowTough").checked),noSubmit=0,"MCQ-4"!=globalProcessquesType&&"MCQ-3"!=globalProcessquesType&&"MCQ-2"!=globalProcessquesType&&(disableEnableBoxes(!1),document.getElementById("b1")&&document.getElementById("b1").focus(),$("#submitQuestion").css("display","block"),showSkip("1"),$("#submitQuestion2").css("display","block"),showSkip("3"),$("#submitQuestion1").css("display","block"),showSkip("2")),$("#toughQuestionClick,#blackScreen").css("display","none"),toughQuestionStatus1=1,calcAns(globalProcessResult,globalProcessquesType),stopTheTimerTough(),timeTakenToughAttempt=0,startTheTimerToughAttempt()}function submitToughQuestionAlert(){stopTheTimerTough(),storageEnabled()&&localStorage.setItem("toughDisabled",document.getElementById("dontShowTough").checked),noSubmit=0,disableEnableBoxes(!1),$("#toughQuestionClick,#blackScreen").css("display","none"),giveResult=1,toughQuestionStatus1=2,"Blank"==globalProcessquesType?submitAnswer():calcAns(globalProcessResult,globalProcessquesType)}function showSkip(e){var t=$("#qcode").val(),s=skipQuestions.indexOf(t);1==e&&(-1!=s&&"wildcard"==$("#quesCategory").val()?$("#skipQuestion").css("display","block"):$("#skipQuestion").css("display","none")),2==e&&(-1!=s&&"wildcard"==$("#quesCategory").val()?$("#skipQuestion1").css("display","block"):$("#skipQuestion1").css("display","none")),3==e&&(-1!=s&&"wildcard"==$("#quesCategory").val()?$("#skipQuestion2").css("display","block"):$("#skipQuestion2").css("display","none"))}function disableEnableBoxes(e){for(var t=0;7>t;t++)document.getElementById("b"+t)&&(document.getElementById("b"+t).disabled=e),document.getElementById("fracB_"+t)&&jQuery("#fracB_"+t).removeAttr("contenteditable").attr("disabled",e);for(var s=document.getElementsByTagName("select"),t=0;t<s.length;t++)"lstOpt"==s[t].id.substr(0,6)&&(s[t].disabled=e)}function quitTopic(){redirect=0,$("#mode").val("topicQuit"),$("#quesform").attr("action","controller.php"),setTryingToUnload(),document.forms[0].submit()}function sendMail(e){try{{$.ajax("controller.php",{type:"post",data:e,success:function(e){resp=e,$("#comment").val("")}})}}catch(t){alert("sendMail "+t.description)}}function mailComment(){if($("#commentInfo").is(":visible")){if(""==$("#commentInfo").find("#selCategory").val()){if(!$(".promptContainer").is(":visible")){new Prompt({text:"Please select category!",type:"alert",promptId:"commentValidation",func1:function(){jQuery("#prmptContainer_commentValidation").remove()}})}return $("#commentInfo #selCategory").focus(),!1}if(""==$("#commentInfo").find("#txtcomment").val()){if(!$(".promptContainer").is(":visible")){new Prompt({text:"Please enter a comment!",type:"alert",promptId:"commentValidation",func1:function(){jQuery("#prmptContainer_commentValidation").remove()}})}return $("#commentInfo #comment").focus(),!1}var e="";e+="problemid="+escape($("#problemid").val()),e+="&comment="+escape($("#commentInfo").find("#txtcomment").val()),e+="&quesNo="+escape($("#qno").val()-1),e+="&qcode="+escape(prevQcodeAfterNext),e+="&selCategory="+escape($("#commentInfo").find("#selCategory").val()),e+="&type="+escape(prevQuesCategoryAfterNext),e+="&previousQuestionDetails=",e+="&mode=comment",sendMail(e)}else{if(""==trim($("#selCategory").val())){if(!$(".promptContainer").is(":visible")){new Prompt({text:"Please select category!",type:"alert",promptId:"commentValidation",func1:function(){jQuery("#prmptContainer_commentValidation").remove()}})}return $("#selCategory").focus(),!1}if(""==trim($("#txtcomment").val())){if(!$(".promptContainer").is(":visible")){new Prompt({text:"Please enter a comment!",type:"alert",promptId:"commentValidation",func1:function(){jQuery("#prmptContainer_commentValidation").remove()}})}return $("#txtcomment").focus(),!1}var e="";e+="problemid="+escape($("#problemid").val()),e+="&comment="+escape($("#txtcomment").val()),1==submitCheck?(e+="&qcode="+escape(prevQcode),e+="&quesNo="+escape(prevQno),e+="&type="+escape(prevQuesCategory)):(e+="&quesNo="+escape($("#qno").val()),e+="&qcode="+escape($("#qcode").val()),e+="&type="+escape($("#quesCategory").val())),e+="&selCategory="+escape($("#selCategory").val()),e+=""!=prevQcodeAfterNext?"&previousQuestionDetails="+escape(prevQcodeAfterNext+"~"+prevQuesCategoryAfterNext):"&previousQuestionDetails=",3==$(".commentOn:checked").val()&&(e+="&notRelatedToQuestion=1"),e+="&mode=comment",sendMail(e)}hideCommentBox()}function hideCommentBox(){$("#commentInfo").is(":visible")?$("#wildcardInfo").click():($("#txtcomment").val(""),$("#selCategory").val(""),$("#commentOn1").attr("checked",!0),""!=document.getElementById("result").value&&(document.getElementById("pnlAnswer").style.display="block"),document.getElementById("pnlQuestion").style.display="block",$("#commentBox").css("display","none"))}function trim(e){var t=e.replace(/\s+/g,"");return t.toUpperCase()}function unique(e){var t=new Array;e:for(var s=0,o=e.length;o>s;s++){for(var n=0,r=t.length;r>n;n++)if(trim(t[n])==trim(e[s]))continue e;t[t.length]=e[s]}return t}function stopTheTimer(){timerRunning&&clearTimeout(timerID),timerRunning=!1}function stopTheTimerTough(){clearTimeout(timerIDTough)}function startTheTimer(){secs+=1,timerRunning=!0,timerID=window.setTimeout("startTheTimer()",1e3)}function startTheTimerToughAlert(){timeTakenToughAlert+=1,timerIDTough=window.setTimeout("startTheTimerToughAlert()",1e3)}function startTheTimerToughAttempt(){timeTakenToughAttempt+=1,timerIDTough=window.setTimeout("startTheTimerToughAttempt()",1e3)}function initializeTimer(){secs=0,disableSubmitButton(),document.getElementById("btnTopicChange")&&(document.getElementById("btnTopicChange").disabled=!1),startTheTimer()}function noimage(e){var t=$(e).attr("data-atp"),s=$(e).attr("src").split("?");(null==t||"undefined"==typeof t||""==t)&&(t=1),t>5?($(e).attr("onerror",""),$.post("errorLog.php","request- "+$("#quesform").find("input").serialize()+" imgName-"+s[0]+"&qcode="+$("#qcode").val()+"&typeErrorLog=imageNotLoading",function(){})):(t++,setTimeout(function(){$(e).attr("src",s[0]+"?"+(new Date).getTime()),$(e).attr("data-atp",t)},750))}function checkImage(e){for(var t=new Array,s=e.split(","),o=0;o<s.length;){try{imgName=s[o],t[o]=new Image,t[o].src=s[o]}catch(n){}o++}}function checkKeyPress(e){var t=e?e.which:window.event.keyCode;if(1!=noSubmit&&13==t&&!$(".promptContainer").is(":visible")&&!$("#clusterStatusPrompts").is(":visible")&&!$("#commentBox").is(":visible"))if(""==$("#result").val())if("daTest"==$("#quesCategory").val());else if("NCERT"==$("#tmpMode").val())submitAnswer();else if("MCQ"==newQues.quesType.substring(0,3)){if(!$(".promptContainer").is(":visible")){new Prompt({text:i18n.t("questionPage.answerNotGivenMsg"),type:"alert",promptId:"specifyAnswer",func1:function(){jQuery("#prmptContainer_specifyAnswer").remove()}})}}else submitAnswer();else"NCERT"==$("#tmpMode").val()||$("#pnlLoading").is(":visible")||1==allowed&&($("#nextQuestion1").css("display","none"),handleClose())}function my_onkeydown_handler(e){var e=e||window.event;switch(shortcut.add("Ctrl+F5",function(){return!1}),shortcut.add("Alt+LEFT",function(){return!1}),shortcut.add("Alt+RIGHT",function(){return!1}),shortcut.add("Ctrl+R",function(){return!1}),shortcut.add("Backspace",function(){}),shortcut.add("Alt+Backspace",function(){return!1}),e.keyCode){case 13:redirect=0;break;case 116:if(""!=document.getElementById("result").value)return cancelKey(e),!1}}function cancelKey(e){return e.preventDefault?(e.preventDefault(),document.getElementById("mode").value="refresh",redirResult(),!1):(e.keyCode=0,e.returnValue=!1,document.getElementById("mode").value="refresh",redirResult(),void 0)}function createCookie(e,t,s){if(s){var o=new Date;o.setTime(o.getTime()+24*s*60*60*1e3);var n="; expires="+o.toGMTString()}else var n="";document.cookie=e+"="+t+n+"; path=/"}function readCookie(e){for(var t=e+"=",s=document.cookie.split(";"),o=0;o<s.length;o++){for(var n=s[o];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return null}function saveEmot(e,t){toolClick=1,toolbar();var s=new Array;s.Like=1,s.Dislike=2,s["I am loving it!"]=3,s["Great question!"]=4,s["Too easy."]=5,s["I hate this question."]=6,s["Questions are repeating."]=7,s["I didn't understand this question."]=8,s["No idea how to solve this."]=9,s["Question is confusing."]=10,s["Question is difficult."]=11,s.Excited=12,s.Confused=13,s.Bored=14,t.parent().addClass("hoverClass"),"Comment"!=e&&(emotID=s[e]),window.clearTimeout(etTimer)}function saveEmotByAjax(e){if(""!=e){var t=prevQcode;$.post("controller.php","qcode="+t+"&emotID="+e+"&mode=saveEmot",function(){emoteToolbarTagCount++,10==emoteToolbarTagCount&&($(".emotIcons").find("label").remove(),$(".emotIcons").append('<h4 align="center">You have already tagged 10 questions!</h4>'))})}e=""}function animateSparkie(e){if("noOfSparkie"==e)var t="#noOfSparkie";else var t=".bubble";$(t).animate({borderSpacing:360},{step:function(e){$(this).css("-webkit-transform","rotate("+e+"deg)"),$(this).css("-moz-transform","rotate("+e+"deg)"),$(this).css("-ms-transform","rotate("+e+"deg)"),$(this).css("-o-transform","rotate("+e+"deg)"),$(this).css("transform","rotate("+e+"deg)")},duration:2500},"linear")}function showClassLevelCompletion(){redirect=0,document.quesform.action="classLevelCompletion.php",setTryingToUnload(),document.quesform.submit()}function clickIE(){return document.all?(window.status=message,!1):void 0}function clickNS(e){return!(document.layers||document.getElementById&&!document.all)||2!=e.which&&3!=e.which?void 0:(window.status=message,!1)}function getFlashMovieObject(e){return window.document.simplemovieQ?window.document.simplemovieQ:-1!=navigator.appName.indexOf("Microsoft Internet")?window.document.getElementById("simplemovieQ"):window.document.controller.embeds&&window.document.controller.embeds[e]?window.document.controller.embeds[e]:void 0}function quitHigherLevel(){$("#higherLevelClick,#blackScreen").show()}function showTagBox(e,t,s){document.getElementById("showTaggedQcode").innerHTML="Need to modify qcode: "+s,document.getElementById("tagQcode").value=s,document.getElementById(e).style.display=t,document.getElementById("tagComment").value="",document.getElementById("tagComment").focus()}function stopAnswerTimer(){clearTimeout(timeToAnswerID),timeToAnswer=0}function startAnswerTimer(){timeToAnswer=parseInt(timeToAnswer+1),timeToAnswerID=window.setTimeout("startAnswerTimer()",1e3)}function stopHintTimer(){clearTimeout(timeTakenToViewHintID),timeTakenToViewHint=0}function startHintTimer(){timeTakenToViewHint=parseInt(timeTakenToViewHint+1),timeTakenToViewHintID=window.setTimeout("startHintTimer()",1e3)}function playVoiceover(e){if("Q"==e){var t=document.getElementById("one");voicePlaying=isPlaying(t),0==voicePlaying&&($("#voiceOverImage").css("background-position","-65px -5px"),t.play(),$.post("controller.php","mode=voiceOverLog&qcode="+$("#qcode").val(),function(){}))}}function sparkieForExplaination(){return quesNoInFlow++,5==quesNoInFlow&&(quesNoInFlow=0,sparkieForExplainationFlag=1),sum(timeTakenExplainationArr)/sum(timeTakenAttemptArr)>.4&&1==sparkieForExplainationFlag?(timeTakenAttemptArr=new Array(0,0,0,0,0),timeTakenExplainationArr=new Array(0,0,0,0,0),sparkieForExplainationFlag=0,quesNoInFlow=0,!0):!1}function sum(e){for(var t=0,s=0;s<e.length;s++)t+=parseInt(e[s]);return t}function getImportantQues(){if(confirm("You will get only important questions")){$("#report").remove(),$("#impQuesMode").val("1");var e=document.getElementById("qno").value;params="qcode=0&mode=firstQuestion&quesCategory="+category+"&qno="+e+"&impQuesMode=1",getNextQues(params,"normal"),fetchNextQues()}}function logoff(){redirect=0,finalSubmit(6)}function frustrationModel(){this.arrQuesResult=Array(5),this.Feature1=0,this.Feature2=0,this.Feature3=0,this.Feature4=0,this.Feature5=0,this.msgCount=0,this.avgResponseTime=22,this.responseRate=80,this.F_current=0,this.F_prev=0,this.frustInst=0;for(var e=0;5>e;e++)this.arrQuesResult[e]=""}function storageEnabled(){try{localStorage.setItem("__test","data")}catch(e){return!1}return!0}function redirectDiagnostic(){var e=document.getElementById("nextQcode").value;"-2"!=e&&"-3"!=e&&"-1"!=e&&"-8"!=e&&(e=document.getElementById("mode").value,e=e.replace(/^\s*|\s*$/g,"")),"completeComprhensive"==$("#mode").val()?$("#diagnosticTest").attr("action","dashboard.php"):"-2"==e||"-3"==e||"-5"==e||"-6"==e?(document.getElementById("mode").value=e,document.getElementById("diagnosticTest").action="endSessionReport.php"):"-8"==e?document.getElementById("diagnosticTest").action="classLevelCompletion.php":"-1"==e?(document.getElementById("mode").value=e,document.getElementById("diagnosticTest").action="dashboard.php"):1==document.getElementById("remedialMode").value?document.getElementById("diagnosticTest").action="remedialItem.php":1==document.getElementById("timedtestMode").value?document.getElementById("diagnosticTest").action="timedTest.php":1==document.getElementById("activityMode").value?document.getElementById("diagnosticTest").action="enrichmentModule.php":1==document.getElementById("clusterMode").value?(document.getElementById("mode").value="comprehensiveAfterActivity",document.getElementById("diagnosticTest").action="controller.php"):document.getElementById("diagnosticTest").action="question.php",setTryingToUnload(),document.getElementById("diagnosticTest").submit()}function diagnosticTestPromptPromptfn(){$.fn.colorbox({href:"#diagnosticTestPrompt",inline:!0,open:!0,escKey:!0,height:260,width:550})}function isPlaying(e){return!e.paused&&0<e.currentTime}function voicePlayFinished(){$("#voiceOverImage").css("background-position","-5px -5px")}function redirect_to_ncert_exercises(){redirect=0,setTryingToUnload(),window.location.href="msAsStudent"==userType?"home.php":"homeworkSelection.php"}function saveNCERTAnswer(){var e=$(".groupNav.current").attr("id").replace(/groupNav/g,"");if(e=parseInt(e),($("#submitQuestion").is(":visible")||$("#submitQuestion2").is(":visible"))&&!isNaN(e)){allowed=1,$("#quesform").attr("disabled",!1);var t=new Array,s=new Array;$(".singleQuestion").each(function(){var e="",o="";$(this).contents().find("select").each(function(){e+=$(this).val()+"|"}),$(this).contents().find("input, iframe").each(function(){$(this).hasClass("openEnded")?(o+=$(this)[0].contentWindow.storeAnswer("")+"@$*@",o+=$(this)[0].contentWindow.tools.save()+"@$*@"):"text"==$(this).attr("type")?e+=$(this).val()+"|":"radio"==$(this).attr("type")&&$(this).is(":checked")&&(e+=$(this).val()+"|")}),""!=e&&(e=e.substring(0,e.length-1)),""!=o&&(o=o.substring(0,o.length-1)),t.push(e),s.push(removeInvalidChars(o))});var o=t.join("##"),s=s.join("##");$("#userResponse").val(o),$("#eeResponse").val(s),$("#mode").val("submitAnswer"),$("#mode").val("fetchNCERTQuestion"),$("#result").val(e),$("#nextQuesLoaded").val("0");var n=$("#quesform").find("input").serialize();getNextQues(n,"normal"),fetchNextQues()}}function openTopicRepeatAttempt(e){if(e>=3&&5>=e){var t=i18n.t("questionPage.topicRepeatAttemptPrompt1");t=3==e?t.replace("###",e+"rd"):t.replace("###",e+"th"),$("#promptHeader").append(i18n.t("questionPage.topicRepeatAttemptPromptHead")),$("#promptData").html(t),isAndroid&&isChrome?JsAlertopenTopicRepeatAttempt(t):$("#topicRepeatAttempt,#blackScreen").show(),noSubmit=1}else if(e>=6&&9>=e){var t=i18n.t("questionPage.topicRepeatAttemptPrompt2");t=t.replace("###",e+"th"),t+=6==e?" "+i18n.t("questionPage.topicRepeatCQTextAppend"):"",$("#promptHeader").append(i18n.t("questionPage.topicRepeatAttemptPromptHead")),$("#promptData").html(t),isAndroid&&isChrome?JsAlertopenTopicRepeatAttempt(t):$("#topicRepeatAttempt,#blackScreen").show(),noSubmit=1}else if(e>=10&&19>=e){var t=i18n.t("questionPage.topicRepeatAttemptPrompt3");t=t.replace("###",e+"th"),$("#promptHeader").append(i18n.t("questionPage.topicRepeatAttemptPromptHead")),$("#promptData").html(t),isAndroid&&isChrome?JsAlertopenTopicRepeatAttempt(t):$("#topicRepeatAttempt,#blackScreen").show(),noSubmit=1}else if(e>=20){var t=i18n.t("questionPage.topicRepeatAttemptPrompt4");e%10==1&&(10>e%100||e%100>20)&&(t=t.replace("###",e+"st")),e%10==2&&(10>e%100||e%100>20)&&(t=t.replace("###",e+"nd")),t=e%10==3&&(10>e%100||e%100>20)?t.replace("###",e+"rd"):t.replace("###",e+"th"),$("#promptHeader").append(i18n.t("questionPage.topicRepeatAttemptPromptHead")),$("#promptData").html(t),isAndroid&&isChrome?JsAlertopenTopicRepeatAttempt(t):$("#topicRepeatAttempt,#blackScreen").show(),noSubmit=1}}function closeTopicRepeatAttempt(){$("#topicRepeatAttempt,#blackScreen").hide(),noSubmit=0}function JsAlertopenTopicRepeatAttempt(e){alert(e),closeTopicRepeatAttempt()}function endsessionJsAlert(){confirm(i18n.t("questionPage.endSessionText"))&&(setTryingToUnload(),finalSubmit(1))}function endtopicJsAlert(){confirm(i18n.t("questionPage.endTopicText"))&&(setTryingToUnload(),changeTopic())}function quittopicJsAlert(){confirm(i18n.t("questionPage.quitHighLevelText"))&&quitTopic()}var toolClick=0,click=0,infoClick=0,isLoadedDAQue=!0,secs,secsTaken=0,plstart=new Date,timerID=null,timerRunning=!1,slowLoadTimer,toughQues=0,isTough="",noSubmit=0,emotID="",prevQcode="",prevQno="",prevQuesCategory="",prevQcodeAfterNext="",prevQuesCategoryAfterNext="",prevQuesHtml="",refreshProgessBar=0,commenttype="",prevQuesClone="",sdlAttemptArr=new Array,clusterAttemptArr=new Array,clusterNameAttemptArr=new Array,topicAttemptArr=new Array,clusterStatusPrompt=0,previousCluster,allowed=1,checkFlag="false",previousCommonError="",allowCommonError=!0,submitCheck=0,giveResult=0,redirect=1,counter=0,etTimer=null,glossaryDescArray=new Array,autoHideDisplayBar,emoteToolbarTagCount=0,noOfCondition=0,conCheck=0,condition,action,ano=1,totalAttempts,timeToAnswer=0,timeToAnswerID,userAllAnswers="",timeTakenToViewHintID,timeTakenForAllHintStr,timeTakenToViewHint=0,timeTakenForAllHints=new Array,questionsDoneEC=0,quesCorrectEC=0,ua=navigator.userAgent.toLowerCase(),isAndroid=ua.indexOf("android")>-1,isIpad=ua.indexOf("ipad")>-1,isChrome=ua.indexOf("chrome")>-1,newQues,objNextQuestion,objFrustration=new frustrationModel,toughQuestionStatus=0,toughQuestionStatus1=0,globalProcessResult="",trialTough=0,submitBlocked=localStorage.getItem("blockSubmit"),globalProcessquesType="",previouslyPrompted=localStorage.getItem("previousPrompted"),captureResets=localStorage.getItem("captureReset"),quesNoInFlow=0,timeTakenAttemptArr=new Array(0,0,0,0,0),timeTakenExplainationArr=new Array(0,0,0,0,0),sparkieForExplainationFlag=0,sparkieCount=0,tryNo=0,backToRemediationCluster=0,practicClusterFlag=0,currentCluster="",nameOfCluster="",quesAttempted,quesCorrect1,progressInTopic,lowerLevel1,diagnosticTestComplete=0,keypadPresent=0,ajaxFailure=!0,dragging=0,JSerrors="",responseArray="",retryNo=0,atHigherLevel=0,toughQuesInstances=0,toughQuesInstancesConsecutive=0,timeTakenToughAlert=0,timeTakenToughAttempt=0,timerIDTough,toughDisabled=0,toughFlag=0,message="Sorry, right-click has been disabled",optionDiagnosticArray=new Array;document.addEventListener?document.addEventListener("keydown",my_onkeydown_handler,!0):document.attachEvent&&document.attachEvent("onkeydown",my_onkeydown_handler),window.history.forward(1),document.onkeypress=checkKeyPress,document.layers&&document.captureEvents(Event.KEYPRESS),window.onload=function(){var e;if($("input[type=text]").live("paste",function(e){if(e.preventDefault(),!$(".promptContainer").is(":visible")){new Prompt({text:"Copy paste not allowed ",type:"alert",promptId:"copyPaste",func1:function(){jQuery("#prmptContainer_copyPaste").remove()}})}$("#promptBox").css("min-height","100px"),$(".butt1").focus()}),$("input[type=text]").live("keyup",function(){e=0}),$("input[type=text]").live("input",function(){var e=$(this).data("old_value")||"",t=$(this).val();t.length-e.length>1&&$(this).val(e),$(this).data("old_value",$(this).val())}),0==window.location.hash.length){window.location.hash="Mindspark",window.location.hash="Loading",("topicRevision"==$("#quesCategory").val()||"diagnosticTest"==$("#quesCategory").val())&&$("#progress_bar").hide(),"diagnosticTest"==$("#quesCategory").val()&&$("#changeTopic").hide(),isAndroid||isIpad||(autoHideDisplayBar=setTimeout(function(){0==infoClick?hideBar():clearTimeout(autoHideDisplayBar)},5e3));var t=$("#quesCategory").val();if("practiseTest"==t){var s=document.getElementById("qcode").value;params="qcode="+s+"&mode=firstQuestion&quesCategory="+t+"&qno="+o}else if("daTest"==t){var o=$("#qno").val(),n=$("#daTestQueCount").val(),r=$("#daPaperCode").val(),a=$("#maxAttemptQno").val();for(i=1;i<a;i++)$("#"+i+"box").addClass("daPagingGrey"),$("#"+i+"box").removeAttr("onclick");for(i=a;i<=parseInt($("#daTestQueCount").val());i++)i==a?($("#"+i+"box").removeClass("daPagingnormal"),$("#"+i+"box").addClass("daPagingBlue")):($("#"+i+"box").removeClass("daPagingGrey"),$("#"+i+"box").addClass("daPagingnormal"));params="qcode=0&mode=firstQuestion&quesCategory="+t+"&qno="+o+"&daTestCode="+r+"&paperQueCount="+n}else params="qcode=0&mode=firstQuestion&quesCategory="+t+"&qno="+o;getNextQues(params,"normal"),refreshProgessBar=1,fetchNextQues(),document.getElementById("ichar")&&buddyinit(),"NCERT"==t&&($("#topic_ncert").css("display","block"),$(".bubble").css("display","none"),$("#chart").css("display","block"),$("#boxRed").css("display","block"),$("#boxGreen").css("display","block"),$(".pending").css("display","inline-block"),$(".complete").css("display","inline-block"),$(".PS").css("display","block"),$("#nextQuestion").css("display","block"),$("#submitQuestion").css("display","none"),$("#submitQuestion2").css("display","none"),$("#skipQuestion").css("display","none"),$("#skipQuestion2").css("display","none"),$("#question").css("margin-top","0px"),$("#toolContainer").css("margin-top","150px"))}else{{$.ajax("controller.php",{type:"post",data:"mode=back_refresh",async:!1,success:function(){}})}setTryingToUnload(),window.location="error.php"}},window.onhashchange=function(){window.location.hash="Mindspark"},$(document).ready(function(){document.onkeypress=checkKeyPress,document.layers&&document.captureEvents(Event.KEYPRESS),document.layers?(document.captureEvents(Event.MOUSEDOWN),document.onmousedown=clickNS):(document.onmouseup=clickNS,document.oncontextmenu=clickIE),document.oncontextmenu=new Function("return false"),window.onerror=function(e,t,s){JSerrors="onerror: "+e+" URL:"+t+" Line:"+s},"true"==localStorage.getItem("toughDisabled")&&(toughDisabled=1),$("input[type='text']").live("focus",function(){$(this).removeClass("incorrectblank")}),progressBarFlag&&$("#showProgressBar").live("click",function(){"none"==$("#progressOverlay").css("display")?($("#showProgressBar").html("-"),$("#progressOverlay").css("display","block"),$(".arrow-top").css("display","block")):($("#showProgressBar").html("+"),$("#progressOverlay").css("display","none"),$(".arrow-top").css("display","none"))}),$("#wildcardImg").live("click",function(){$("#wildcardInfo").dialog({width:"400px",position:"right",draggable:!1,resizable:!1,modal:!0})}),$(".eqEditorToggler").live("click",function(){$(this).parents("td:first").next().find(".eqEditorConatiner:first").toggle("slow")}),$(".ui-widget-overlay").live("click",function(){$("#wildcardInfo,#commentInfo").dialog("close"),$("#commentInfo").html("")}),$("#wildcardInfo").live("click",function(){$("#wildcardInfo,#commentInfo").dialog("close"),$("#commentInfo").html("")}),$("#ui-dialog-titlebar").live("click",function(){$("#wildcardInfo,#commentInfo").dialog("close"),$("#commentInfo").html("")}),$(".groupNav").click(function(){var e=$(this).attr("id").replace(/groupNav/g,"");if(!$(this).hasClass("current")){if(allowed=1,$("#submitQuestion").is(":visible")){$("#quesform").attr("disabled",!1);var t=new Array,s=new Array;$(".singleQuestion").each(function(){var e="",o="";$(this).contents().find("select").each(function(){e+=$(this).val()+"|"}),$(this).contents().find("input, iframe").each(function(){$(this).hasClass("openEnded")?(o+=$(this)[0].contentWindow.storeAnswer("")+"@$*@",o+=$(this)[0].contentWindow.tools.save()+"@$*@"):"text"==$(this).attr("type")?e+=$(this).val()+"|":"radio"==$(this).attr("type")&&$(this).is(":checked")&&(e+=$(this).val()+"|")}),""!=e&&(e=e.substring(0,e.length-1)),""!=o&&(o=o.substring(0,o.length-1)),t.push(e),s.push(removeInvalidChars(o))});var o=t.join("##"),s=s.join("##");$("#userResponse").val(o),$("#eeResponse").val(s)}else $("#userResponse").val("-1");$("#mode").val("submitAnswer"),$("#mode").val("fetchNCERTQuestion"),$("#result").val(e),$("#nextQuesLoaded").val("0");var n=$("#quesform").find("input").serialize();getNextQues(n,"normal"),fetchNextQues()}}),$("input:text").length>0&&$("input:text:first").focus(),$(document).click(function(){$(".moreOption").hide()}),$("#emotToolBar *").click(function(e){e.stopPropagation()}),$("input[name=moreOption]").click(function(){saveEmot($(this).val(),$(this))}),$("input[name=emotRespond]").click(function(){$(".close").click(),$(".hoverClass").removeClass("hoverClass"),saveEmot($(this).val(),$(this))}),$("#showHint").live("click",function(){if("MCQ"==newQues.quesType.substring(0,3)&&1==newQues.noOfTrialsAllowed&&10>timeToAnswer){if(!$(".promptContainer").is(":visible")){new Prompt({text:"You seem to be using the hint very soon. Did you read the question completely?",type:"alert",promptId:"earlyHintUse",func1:function(){jQuery("#prmptContainer_earlyHintUse").remove()}})}}else{for(var e=1;e<newQues.hintAvailable;e++)$("#timeTakenHints").val($("#timeTakenHints").val()+"||0");startHintTimer(),$("#showHint").hide(),$("#isHintUsefull").attr("checked",!1),$("#isHintUsefull").val("0"),$(".hintDiv").fadeIn(1e3),$("#hintUsed").val(1)}}),$("#nextHint").live("click",function(){for(var e=newQues.hintAvailable,t=1;e>t;t++)if(document.getElementById("hintText"+t)&&$("#hintText"+t).is(":visible")){timeTakenForAllHints=$("#timeTakenHints").val().split("||"),timeTakenForAllHints[t-1]=parseInt(timeTakenForAllHints[t-1])+timeTakenToViewHint,timeTakenForAllHintStr=timeTakenForAllHints.join("||"),$("#timeTakenHints").val(timeTakenForAllHintStr),stopHintTimer(),startHintTimer(),$("#prevHint").is(":visible")||$("#prevHint").show(),$("#hintText"+t).hide(),$("#hintText"+(t+1)).show(),$("#hintUsed").val()<t+1&&$("#hintUsed").val(t+1),t==e-1&&$("#nextHint").hide();break}}),$("#prevHint").live("click",function(){for(var e=newQues.hintAvailable,t=2;e+1>t;t++)if(document.getElementById("hintText"+t)&&$("#hintText"+t).is(":visible")){timeTakenForAllHints=$("#timeTakenHints").val().split("||"),timeTakenForAllHints[t-1]=parseInt(timeTakenForAllHints[t-1])+timeTakenToViewHint,timeTakenForAllHintStr=timeTakenForAllHints.join("||"),$("#timeTakenHints").val(timeTakenForAllHintStr),stopHintTimer(),startHintTimer(),$("#prevHint").is(":visible")||$("#prevHint").show(),$("#hintText"+t).hide(),$("#hintText"+(t-1)).show(),2==t&&$("#prevHint").hide(),t==e&&$("#nextHint").show();break}}),$("#isHintUsefull").click(function(){$("#isHintUsefull").val($("#isHintUsefull").is(":checked")?"1":"0")}),$(".commentOn").live("click",function(){if(2==$(this).val()){var e=$("#selCategory").val();$("#selCategory").val(""),$("#commentBox").hide(),$("#commentOn1").attr("checked",!0),prevQuesClone.appendTo("#commentInfo"),$("#commentInfo #mainHint").remove(),$("#commentInfo #mainHint").next("br").remove(),$("#commentInfo #submit_bar1").remove(),$("#commentInfo #displayanswer").html($("#commentInfo #displayanswer").html().replace("Please click the Next Question button to continue.","")),$("#commentInfo #displayanswer").html($("#commentInfo #displayanswer").html().replace("<br>Please click the Next Question button to continue!!<br><br>","")),$("#commentInfo #displayanswer").html($("#commentInfo #displayanswer").html().replace("<br>","")),$("#commentInfo #feedback_header").css("font-size","1.2em"),$("#commentInfo").append("<div style='clear:both'></div>"),$("#commentInfo #question .optionX").removeAttr("onclick"),$("#commentBox").clone().appendTo("#commentInfo"),$("#commentInfo #questionSelect").remove(),""!=e&&$("#commentInfo #selCategory").val(e),$("#commentInfo #commentBox").show(),$("#commentInfo #commentBoxTr").show(),$("#commentInfo").dialog({width:"90%",height:"600",position:"center",draggable:!1,resizable:!1,modal:!0}),$(".ui-widget-header").css("background","#39A9E0"),$(".ui-widget-content").css("background","#FFFFFF"),$("#commentInfo #selCategory").css({"font-family":"Helvetica,Arial,sans-serif","font-size":"17px"}),$("#commentInfo #comment").css({"font-family":"Helvetica,Arial,sans-serif","font-size":"17px"}),$("#commentInfo").animate({scrollTop:$(document).height()},1e3)
}}),$("#selCategory").change(function(){$("#commentBoxTr").show()}),$("#tagComentSave").click(function(){var e=$("#tagComment").val(),t=$("#tagQcode").val();if(""==e){if(!$(".promptContainer").is(":visible")){new Prompt({text:"You can not tag a question without commenting.",type:"alert",promptId:"commentValidation",func1:function(){jQuery("#prmptContainer_commentValidation").remove()}})}return document.getElementById("tagMsgBox").style.display="none",!1}$.post("controller.php","mode=tagThisQcode&qcode="+t+"&msg="+e+"&type="+$("#quesCategory").val(),function(e){e&&$("#tagtoModify"+t).hide()}),$("#tagMsgBox").hide()});var e=readCookie("mindspark");null!=e&&(e=JSON.parse(e),objFrustration.F_current=e.F_current,objFrustration.arrQuesResult=e.arrQuesResult,objFrustration.F_prev=e.F_prev,objFrustration.frustInst=e.frustInst);if($("#toolContainer,#radioButtons,#progressOverlay").draggable({containment:"document",start:function(){dragging=1},stop:function(){window.setTimeout(function(){dragging=0},100)}}),$(".questionPrompts").draggable({containment:"#blackScreen"}),$(".questionPrompts").on("touchmove",function(e){$("#pnlQuestion").has($(e.target)).length||e.preventDefault()}),"msAsStudent"==userType){var t=$("#container").width()-$("#msAsStudentInfo").width();$(".questionPrompts1").draggable({containment:[0,0,t,600],drag:function(){$("#msAsStudentInfo").css("right","")}}),$(".questionPrompts1").on("touchmove",function(e){$("#pnlQuestion").has($(e.target)).length||e.preventDefault(),$("#msAsStudentInfo").css("right","")})}$("#blackScreen,.questionPrompts,.questionPrompts1").live("touchmove",function(e){e.preventDefault()}),void 0!=document.getElementById("toolContainer")&&(document.getElementById("toolContainer").addEventListener("touchend",function(){0==dragging&&toolbar()},!1),isAndroid||isIpad||document.getElementById("toolContainer").addEventListener("mouseup",function(){0==dragging&&toolbar()},!1))});try{var eventMethod=window.addEventListener?"addEventListener":"attachEvent",eventer=window[eventMethod],messageEvent="attachEvent"==eventMethod?"onmessage":"message",frame=document.getElementById("quesInteractive");eventer(messageEvent,function(e){if("http://mindspark-ei.s3.amazonaws.com"==e.origin||"http://d2tl1spkm4qpax.cloudfront.net"==e.origin||"mindspark-ei.s3.amazonaws.com"==e.origin||"d2tl1spkm4qpax.cloudfront.net"==e.origin){var t="";t=e.data,-1!=t.indexOf("||")&&(response1Array=t.split("||"),result=parseInt(response1Array[0]),$("#userResponse").val(response1Array[1]),result>2&&$.post("errorLog.php","params="+$("#quesform").find("input").serialize()+"&type=3",function(){}),calcAns(result,newQues.quesType))}},!1)}catch(ex){alert("error in getting the response from interactive")}shortcut={all_shortcuts:{},add:function(e,t,s){var o={type:"keydown",propagate:!1,disable_in_input:!0,target:document,keycode:!1};if(s)for(var n in o)"undefined"==typeof s[n]&&(s[n]=o[n]);else s=o;var r=s.target;"string"==typeof s.target&&(r=document.getElementById(s.target));e=e.toLowerCase();var i=function(o){if(o=o||window.event,s.disable_in_input){var n;if(o.target?n=o.target:o.srcElement&&(n=o.srcElement),3==n.nodeType&&(n=n.parentNode),"INPUT"==n.tagName&&"text"==n.type||"TEXTAREA"==n.tagName)return}o.keyCode?code=o.keyCode:o.which&&(code=o.which);var r=String.fromCharCode(code).toLowerCase();188==code&&(r=","),190==code&&(r=".");var i=e.split("+"),a=0,l={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},u={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},c={shift:{wanted:!1,pressed:!1},ctrl:{wanted:!1,pressed:!1},alt:{wanted:!1,pressed:!1},meta:{wanted:!1,pressed:!1}};o.ctrlKey&&(c.ctrl.pressed=!0),o.shiftKey&&(c.shift.pressed=!0),o.altKey&&(c.alt.pressed=!0),o.metaKey&&(c.meta.pressed=!0);for(var d=0;k=i[d],d<i.length;d++)"ctrl"==k||"control"==k?(a++,c.ctrl.wanted=!0):"shift"==k?(a++,c.shift.wanted=!0):"alt"==k?(a++,c.alt.wanted=!0):"meta"==k?(a++,c.meta.wanted=!0):k.length>1?u[k]==code&&a++:s.keycode?s.keycode==code&&a++:r==k?a++:l[r]&&o.shiftKey&&(r=l[r],r==k&&a++);return a!=i.length||c.ctrl.pressed!=c.ctrl.wanted||c.shift.pressed!=c.shift.wanted||c.alt.pressed!=c.alt.wanted||c.meta.pressed!=c.meta.wanted||(t(o),s.propagate)?void 0:(o.cancelBubble=!0,o.returnValue=!1,o.stopPropagation&&(o.stopPropagation(),o.preventDefault()),!1)};this.all_shortcuts[e]={callback:i,target:r,event:s.type},r.addEventListener?r.addEventListener(s.type,i,!1):r.attachEvent?r.attachEvent("on"+s.type,i):r["on"+s.type]=i}},frustrationModel.prototype.getFrustrationMsg=function(e,t,s,o){var n="";if(this.calculateFrustrationIndex(e,t,s,o),this.msgCount=this.Feature1+this.Feature2+this.Feature3+this.Feature4,this.F_current>.49){if(this.frustInst++,$("#childClass").val()<8||1==rewardSystem)var r="Sparkie";else var r="Reward Point";0==this.msgCount?n="":1==this.msgCount?n=this.getMsgForEvent2(t,o):2==this.msgCount?n=this.getMsgForEvent3(o):3==this.msgCount?n=this.getMsgForEvent4(o,r):4==this.msgCount?n=this.getMsgForEvent5(o,r):5==this.msgCount&&(n=this.getMsgForEvent6(o))}return n},frustrationModel.prototype.calculateFrustrationIndex=function(e,t,s,o){this.F_prev=this.F_current;var n=4,r="challenge"==t?1:0;if("normal"==t){for(var i=1;5>i;i++)this.arrQuesResult[i-1]=this.arrQuesResult[i];this.arrQuesResult[i-1]=e}"normal"==t&&4>=s?this.F_current=0:(this.Feature1=(1-this.arrQuesResult[n])*(1-r),this.Feature2=(this.arrQuesResult[n-2]*this.arrQuesResult[n-1]*(1-this.arrQuesResult[n])+this.arrQuesResult[n-1]*(1-this.arrQuesResult[n]))*(1-r),this.Feature3=(this.arrQuesResult[n-4]*this.arrQuesResult[n-3]*this.arrQuesResult[n-2]*this.arrQuesResult[n-1]*(1-this.arrQuesResult[n])+this.arrQuesResult[n-3]*this.arrQuesResult[n-2]*this.arrQuesResult[n-1]*(1-this.arrQuesResult[n]))*(1-r),this.Feature4=r*(1-e),this.Feature5=o,this.F_current=.8*(.147+.423*(this.Feature1-.25)-.0301*(this.Feature2-.25)/2+.0115*(this.Feature3-.11)/2+.8359*(this.Feature4-.04)+.1864*(this.Feature5-22.5)/300)+.2*this.F_prev)},frustrationModel.prototype.getMsgForEvent2=function(e,t){var s="";return"normal"==e?1==this.frustInst&&t>this.avgResponseTime?s="Good, you tried hard to get the correct answer. Keep trying.":1==this.frustInst&&t<this.avgResponseTime?s="Try harder, you might get the correct answer next time.":2==this.frustInst&&this.responseRate>50?s="It is okay to get the wrong answer sometimes. You may have found the questions hard, but practice will make it easier. Try again.":2==this.frustInst&&this.responseRate<50?s="It seems this question is tough, your friends felt the same, try again":3==this.frustInst&&(s="Would you like to give your feedback?"):"challenge"==e&&(1==this.frustInst&&t>this.avgResponseTime?s="You did well in the last four questions, and have tried hard to answer this challenge question too. Keep trying, you may solve it next time.":1==this.frustInst&&t<this.avgResponseTime?s="You did well in the last four questions. Try harder, you may solve it next time.":2==this.frustInst?s="Don't worry, this is a tough question for many of your friends too. You can attempt it again.":3==this.frustInst&&(s="Would you like to give your feedback?")),s},frustrationModel.prototype.getMsgForEvent3=function(e){var t="";return 1==this.frustInst&&e>this.avgResponseTime?t="You did well in the last question, and have tried hard to answer this question too. I am sure you will do well in the next questions.":1==this.frustInst&&e<this.avgResponseTime?t="You did well in the last question. Try hard, I am sure you will do well in the next questions.":2==this.frustInst&&this.responseRate>50?t="It is okay to get the wrong answer sometimes. You may have found the questions hard, but practice will make it easier. Try again.":2==this.frustInst&&this.responseRate<50?t="It seems this question is tough, your friends felt the same, try again":3==this.frustInst&&(t="Would you like to give your feedback?"),t},frustrationModel.prototype.getMsgForEvent4=function(e,t){var s="";return 1==this.frustInst&&e>this.avgResponseTime?s="You did well in the last two questions, and have tried hard to answer this question too. I am sure you will do well in the next questions.":1==this.frustInst&&e<this.avgResponseTime?s="You did well in the last two questions. Try hard, I am sure you will do well in the next questions.":2==this.frustInst&&this.responseRate>50?s="It is okay to get the wrong answer sometimes. You may have found the questions hard, but practice will make it easier. Try again.":2==this.frustInst&&this.responseRate<50?s="It seems this is a tough question for many of your friends too. Try again. You may get a "+t+" next time.":3==this.frustInst&&(s="Would you like to give your feedback?"),s},frustrationModel.prototype.getMsgForEvent5=function(e,t){var s="";return 1==this.frustInst&&e>this.avgResponseTime?s="You did well in the last three questions and got a "+t+"! You tried hard to answer this question too. I am sure you will do well in the next questions.":1==this.frustInst&&e<this.avgResponseTime?s="You did well in the last three questions. Try hard, I am sure you will do well in the next questions.":2==this.frustInst&&this.responseRate>50?s="It is okay to get the wrong answer sometimes. You may have found the questions hard, but practice will make it easier. Try again.":2==this.frustInst&&this.responseRate<50?s="It seems this is a tough question for many of your friends too. Try again.":3==this.frustInst&&(s="Would you like to give your feedback?"),s},frustrationModel.prototype.getMsgForEvent6=function(e){var t="";return 1==this.frustInst&&e>this.avgResponseTime?t="You did well in the last four questions, and have tried hard to answer this question too. I am sure you will do well in the next questions.":1==this.frustInst&&e<this.avgResponseTime?t="You did well in the last four questions. Try hard, I am sure you will do well in the next questions.":2==this.frustInst&&this.responseRate>50?t="It is okay to get the wrong answer sometimes. You may have found the questions hard, but practice will make it easier. Try again.":2==this.frustInst&&this.responseRate<50?t="It seems this is a tough question for many of your friends too. Try again. You may get a Challenge Question next time.":3==this.frustInst&&(t="Would you like to give your feedback?"),t};