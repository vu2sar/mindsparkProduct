function applyScale(e){globalId=e,$("#"+globalId).live("mouseup",function(){window.focus()}),dimensionArr=getDimensions(),"IMG"==$("#"+e)[0].tagName&&(imageFlag=1,source=$("#"+e).attr("src"));var t="";t+='<div id="'+e+'" title="Move">',t+='<div id="yellowPart" title="move"></div>',t+='<div id="movePart" title="rotate"></div>',t+="</div>",$("#"+e).replaceWith(t);var o='<button id="help1" class="promptOkButton" onclick="showPrompt();">Help</button>';o+='<div id="frontScreen"></div>',o+=prompt(),$("#container").append(o),$("#promptHolder").draggable({containment:"#container"}),resetScale(),addEvents()}function applyCss(){$("label").css({display:"inline-block",width:"5em"}),$("#movePart").css({position:"absolute",top:"0%",width:"40%","background-color":"rgba(0, 255, 216, 0.44)",height:"100%",left:"60%",cursor:"url('../../../../assets/moveicon.png'), move"}),$("#yellowPart").css({position:"absolute",top:"0%",width:"60%","background-color":"rgba(249, 255, 0, 0.439216)",height:"100%",left:"0%",cursor:"move"}),$("#"+globalId).css({border:"none",cursor:"move","transform-origin":"0% 0%","ms-transform-origin":"0% 0%","o-transform-origin":"0% 0%","moz-transform-origin":"0% 0%","webkit-transform-origin":"0% 0%"}),1==imageFlag&&$("#"+globalId).css({"background-image":"url("+source+")","background-repeat":"no-repeat",width:dimensionArr[0],height:dimensionArr[1]}),$("#promptHolder").css({padding:"12px",color:"rgb(2, 0, 0)","font-size":"16px","font-weight":"normal",border:"5px solid rgb(43, 40, 40)",display:"none",background:"rgb(241, 238, 234)","text-align":"center",position:"absolute",top:"10px",right:"10px","z-index":"1000",cursor:"default","-webkit-box-shadow":"5px 3px 17px rgba(172, 149, 149, 0.4)","-moz-box-shadow":"5px 3px 17px rgba(172, 149, 149, 0.4)","-o-box-shadow":"5px 3px 17px rgba(172, 149, 149, 0.4)","-ms-box-shadow":"5px 3px 17px rgba(172, 149, 149, 0.4)",width:"500px"}),$("#frontScreen").css({width:$("#container").css("width"),height:$("#container").css("height"),"background-color":"rgba(0,0,0,0.01)",position:"absolute",top:"0px",left:"0px","z-index":"999",display:"none"}),$("#arrows").css({background:"url('../../../../assets/keys.png')",width:"80px",height:"60px","background-repeat":"no-repeat","background-size":"contain",position:"relative",top:"5px",left:"0px",display:"inline-block","vertical-align":"middle","margin-right":"20px"}),$(".shift").css({background:"url('../../../../assets/shift.png')",width:"80px",height:"31px","background-repeat":"no-repeat","background-size":"contain",position:"relative",top:"5px",left:"0px",display:"inline-block","vertical-align":"middle"}),$("#leftkey").css({background:"url('../../../../assets/leftkey.png')",width:"31px",height:"30px","background-repeat":"no-repeat","background-size":"contain",position:"relative",top:"5px",left:"0px",display:"inline-block","vertical-align":"middle","margin-right":"20px"}),$("#rightkey").css({background:"url('../../../../assets/rightkey.png')",width:"31px",height:"30px","background-repeat":"no-repeat","background-size":"contain",position:"relative",top:"5px",left:"0px",display:"inline-block","vertical-align":"middle","margin-right":"20px"}),$(".text").css({display:"inline-block","vertical-align":"middle","margin-top":"7px","text-align":"center"}),$("#both").css({width:"257px",display:"inline-block",height:"90px","vertical-align":"middle","margin-left":"54px"}),$("#arrowText").css({display:"inline-block","vertical-align":"middle",width:"85px","margin-left":"60px"}),$("#moveText").css({display:"block"}),$(".plus").css({height:"30px","vertical-align":"middle","line-height":"33px",display:"inline-block"}),$("#help1").css({position:"absolute",right:"10px",top:"10px",display:"block",padding:"5px 10px",left:"initial",margin:"0px"})}function addEvents(){$("#movePart").mousedown(function(e){diffValOpt=90,startRight(e)}),document.getElementById("movePart").addEventListener("touchstart",function(e){diffValOpt=90,startRight(e)}),document.addEventListener("touchmove",moveProtractor,!1),document.addEventListener("touchend",function(){isDrag=!1,$("#"+globalId).draggable("enable")})}function startRight(e){isDrag=!0,$("#"+globalId).draggable("disable"),e.preventDefault(),h_y=parseInt($("#"+globalId).css("top")),h_x=parseInt($("#"+globalId).css("left"));var t,o;if(e.touches)t=e.touches[0].clientX,o=e.touches[0].clientY;else{if(!e.pageX)return;t=e.pageX,o=e.pageY}var a=Math.atan2(t-h_x,o-h_y);degree=a*(180/Math.PI)*-1}function moveProtractor(e){if(isDrag){var t,o;if(e.touches)t=e.touches[0].clientX,o=e.touches[0].clientY;else{if(!e.pageX)return;t=e.pageX,o=e.pageY}var a=Math.atan2(t-h_x,o-h_y),r=a*(180/Math.PI)*-1;degree1=startRotation+(r-degree),$("#"+globalId).css("-moz-transform","scaleX("+scaleFactor+") scaleY("+scaleFactor+") rotate("+degree1+"deg)"),$("#"+globalId).css("-webkit-transform","scaleX("+scaleFactor+") scaleY("+scaleFactor+") rotate("+degree1+"deg)"),$("#"+globalId).css("-o-transform","scaleX("+scaleFactor+") scaleY("+scaleFactor+") rotate("+degree1+"deg)"),$("#"+globalId).css("-ms-transform","scaleX("+scaleFactor+") scaleY("+scaleFactor+") rotate("+degree1+"deg)"),$("#"+globalId).css("transform","scaleX("+scaleFactor+") scaleY("+scaleFactor+") rotate("+degree1+"deg)")}}function resetScale(){applyCss(),scaleFactor=1,startRotation=0,degree1=0,degree=0,osDetection()&&$("#promptHolder").css("width","330px")}function rotatered(){clearInterval(interval),rotateFn("-",1),interval=setInterval(function(){rotateFn("-",1)},200)}function rotateblue(){clearInterval(interval),rotateFn("+",1),interval=setInterval(function(){rotateFn("+",1)},200)}function rotateFn(e,t){"-"==e?startRotation-=t:startRotation+=t,degree1=startRotation,$("#"+globalId).css("-moz-transform","scaleX("+scaleFactor+") scaleY("+scaleFactor+") rotate("+startRotation+"deg)"),$("#"+globalId).css("-webkit-transform","scaleX("+scaleFactor+") scaleY("+scaleFactor+") rotate("+startRotation+"deg)"),$("#"+globalId).css("transform","scaleX("+scaleFactor+") scaleY("+scaleFactor+") rotate("+startRotation+"deg)"),$("#"+globalId).css("-o-transform","scaleX("+scaleFactor+") scaleY("+scaleFactor+") rotate("+startRotation+"deg)"),$("#"+globalId).css("-ms-transform","scaleX("+scaleFactor+") scaleY("+scaleFactor+") rotate("+startRotation+"deg)")}function getMeta(e){var t=new Image;t.src=e;var o=t.onload=function(){return s={w:t.width,h:t.height},[s.w,s.h]}();return o}function getDimensions(){var e=[$("#"+globalId).css("width"),$("#"+globalId).css("height")];return e}function prompt(){var e="";return e+='<div id="promptHolder" style="display:none;">',e+='<div id="prompt" style="visibility:hidden;text-align:left;">',osDetection()?(e+="<ol>",e+="<li>Move the ruler using the yellow part.</li>",e+="<li>Rotate the ruler using the green part.</li>",e+="</ol>"):(e+="<ol>",e+="<li>To move the ruler, click on the yellow part and drag. You can also use the arrow buttons to move the ruler as shown below.</li>",e+="<li>To turn the ruler, click on the green part and drag. You can also use Shift + (Left/Right arrow button) to turn the ruler as shown below.</li>",e+="</ol>",e+='<div id="arrowText">',e+='<div id="arrows"></div><div id="moveText" class="text" style="display:block;">Move</div>',e+="</div>",e+='<div id="both">',e+='<div class="shift"></div> <div class="plus">+</div> <div id="leftkey"></div>  <div class="text">Rotate Left</div>',e+='<div class="shift"></div> <div class="plus">+</div> <div id="rightkey"></div>  <div class="text">Rotate Right</div>',e+="</div>"),e+="</div>",e+='<button id="promptOk" class="promptOkButton" promptNo="" onclick="checkPrompt();"  style="visibility:hidden; width: 45px; background-color: white; font-size: 14px;">OK',e+="</button>",e+="</div>"}function checkPrompt(){$("#promptHolder").hide(),$("#frontScreen").hide()}function showPrompt(e,t){$("#frontScreen").show(),$("#promptHolder").css({top:e+"px",left:t+"px"}),$("#promptHolder").show(),$("#promptHolder").children().css("visibility","visible"),"noAnswer"==$("#promptOk").attr("promptNo")&&$("#promptOk,#msg").css("visibility","hidden"),setTimeout(function(){$("#promptOk").focus()},50)}var source="",isDrag=!1,globalId,protHeight,globalType,imageFlag=0,h_x,h_y,diffValOpt,degree=0,startRotation=0,angle1=0,degree1=0,speed=0;$(document).ready(function(){$(document).live("keyup",function(){clearInterval(interval),speed=0}),$(document).live("keydown",function(e){e.keyCode=0!=e.keyCode?e.keyCode:e.which,speed++,37==e.keyCode&&1==e.shiftKey?rotatered():39==e.keyCode&&1==e.shiftKey?rotateblue():37==e.keyCode?(e.preventDefault(),parseInt($("#"+globalId).css("left"))>-300&&$("#"+globalId).css("left",parseInt($("#"+globalId).css("left"))-Math.ceil(speed/10))):39==e.keyCode?(e.preventDefault(),parseInt($("#"+globalId).css("left"))<parseInt($("#container").css("width"))+125&&$("#"+globalId).css("left",parseInt($("#"+globalId).css("left"))+Math.ceil(speed/10))):38==e.keyCode?(e.preventDefault(),parseInt($("#"+globalId).css("top"))>-300&&$("#"+globalId).css("top",parseInt($("#"+globalId).css("top"))-Math.ceil(speed/10))):40==e.keyCode&&(e.preventDefault(),parseInt($("#"+globalId).css("top"))<450&&$("#"+globalId).css("top",parseInt($("#"+globalId).css("top"))+Math.ceil(speed/10)))}),document.addEventListener("mousemove",moveProtractor,!1),$(document).mouseup(function(){isDrag=!1,$("#"+globalId).draggable("enable"),startRotation=degree1}),document.addEventListener("touchend",function(){isDrag=!1,$("#"+globalId).draggable("enable"),startRotation=degree1})});var scaleFactor=1,interval="",tempDeg=0,dimensionArr;