(function(){function getBlankNo(ques){var matches=ques.match(/\[blank_\d[^\]]*\]/g);if(matches===null)return 1;var maxblankno=0;for(var i=0;i<matches.length;i++){var tmp=matches[i].substring(7,8);if(parseInt(tmp)>maxblankno)maxblankno=parseInt(tmp)}maxblankno+=1;return maxblankno}tinymce.create('tinymce.plugins.mindspark',{init:function(ed,url){ed.addCommand('uploadFile',function(){ed.windowManager.open({file:url+'/uploadFile.php',width:320+ed.getLang('example.delta_width',0),height:120+ed.getLang('example.delta_height',0),inline:1},{plugin_url:url,some_custom_arg:'custom arg'});return false});ed.addCommand('mindsparkBlank',function(){blankCounter=getBlankNo(ed.getContent());ed.execCommand('mceInsertContent',false,'[blank_'+blankCounter+']');return false});ed.addCommand('mindsparkNumeric',function(){blankCounter=getBlankNo(ed.getContent());ed.execCommand('mceInsertContent',false,'[blank_'+blankCounter+',numeric]');return false});ed.addCommand('mindsparkFracbox',function(){blankCounter=getBlankNo(ed.getContent());ed.execCommand('mceInsertContent',false,'[blank_'+blankCounter+',fracbox]');return false});ed.addCommand('mindsparkEqu',function(){ed.execCommand('mceInsertContent',false,'&lt;equ> Type your equation here &lt;/equ>');return false});ed.addCommand('mindsparkFraction',function(){ed.execCommand('mceInsertContent',false,'{frac(a/b)}');return false});ed.addCommand('mindsparkPower',function(){ed.execCommand('mceInsertContent',false,'<span class="math">{x}^{a}</span>');return false});ed.addCommand('mindsparkBMatrix',function(){ed.execCommand('mceInsertContent',false,'&#92;begin{bmatrix} a_{11} & a_{12} & &#92;ldots & a_{1n} &#92;cr a_{21} & a_{22} & &#92;ldots & a_{2n} &#92;cr &#92;vdots & &#92;vdots & &#92;ddots & &#92;vdots &#92;cr a_{m1} & a_{m2} & &#92;ldots & a_{mn} &#92;end{bmatrix}');return false});ed.addCommand('mindsparkPMatrix',function(){ed.execCommand('mceInsertContent',false,'&#92;begin{pmatrix} a_{11} & a_{12} & &#92;ldots & a_{1n} &#92;cr a_{21} & a_{22} & &#92;ldots & a_{2n} &#92;cr &#92;vdots & &#92;vdots & &#92;ddots & &#92;vdots &#92;cr a_{m1} & a_{m2} & &#92;ldots & a_{mn} &#92;end{pmatrix}');return false});ed.addCommand('mindsparkPI',function(){ed.execCommand('mceInsertContent',false,'<span style="font-family: \'Times New Roman\'; font-size: 20px">&pi;</span>');return false});ed.addButton('mindsparkToolbarBlank',{title:'Insert Blank',cmd:'mindsparkBlank',image:url+'/img/blank.jpg'});ed.addButton('mindsparkToolbarNumeric',{title:'Insert Numeric Blank',cmd:'mindsparkNumeric',image:url+'/img/numeric.jpg'});ed.addButton('mindsparkToolbarFracbox',{title:'Insert Fracbox',cmd:'mindsparkFracbox',image:url+'/img/fracbox.jpg'});ed.addButton('mindsparkToolbarEqu',{title:'Add jsMath Tag',cmd:'mindsparkEqu',image:url+'/img/equ.png'});ed.addButton('mindsparkToolbarAbyB',{title:'Fractions',cmd:'mindsparkFraction',image:url+'/img/AbyB.png'});ed.addButton('mindsparkToolbarXpowerY',{title:'X power A',cmd:'mindsparkPower',image:url+'/img/XpowerY.png'});ed.addButton('mindsparkToolbarBmatrix',{title:'Matrix [::]',cmd:'mindsparkBMatrix',image:url+'/img/bmatrix.png'});ed.addButton('mindsparkToolbarPmatrix',{title:'Matrix (::)',cmd:'mindsparkPMatrix',image:url+'/img/pmatrix.png'});ed.addButton('mindsparkToolbarPi',{title:'Mindspark PI',cmd:'mindsparkPI',image:url+'/img/pi.png'});ed.addButton('mindsparkToolbarFU',{title:'Upload a File',cmd:'uploadFile',image:url+'/img/upload.gif'});ed.onNodeChange.add(function(ed,cm,n){cm.setActive('mindsparkToolbar',n.nodeName=='IMG')})},createControl:function(n,cm){return null},getInfo:function(){return{longname:'Mindspark Toolbar',author:'Education Initiative Pvt Ltd',authorurl:'http://www.ei-india.com',infourl:'http://www.ei-india.com',version:"1.0"}}});tinymce.PluginManager.add('mindsparkToolbar',tinymce.plugins.mindspark)})();